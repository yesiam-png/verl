+ export HYDRA_FULL_ERROR=1
+ HYDRA_FULL_ERROR=1
+ ulimit -n 65535
++ pwd
+ PROJECT_DIR=/mnt/task_runtime/verl
+ CONFIG_PATH=/mnt/task_runtime/verl/examples/sglang_multiturn/config
+ python3 -m verl.trainer.main_ppo --config-path=/mnt/task_runtime/verl/examples/sglang_multiturn/config --config-name=gsm8k_multiturn_grpo algorithm.adv_estimator=grpo data.train_batch_size=1024 data.max_prompt_length=128 data.filter_overlong_prompts=True data.truncation=error data.return_raw_chat=True data.filter_overlong_prompts_workers=40 actor_rollout_ref.model.path=/root/.cache/huggingface/hub/models--allenai--OLMo-2-0425-1B/snapshots/a1847dff35000b4271fa70afc5db10fd29fedbdf +actor_rollout_ref.actor.ntp_coeff=1.0 actor_rollout_ref.actor.optim.lr=2e-6 actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.ppo_mini_batch_size=256 +actor_rollout_ref.actor.ntp_mini_batch_size=512 actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=32 +actor_rollout_ref.actor.ntp_micro_batch_size_per_gpu=64 actor_rollout_ref.actor.use_kl_loss=False actor_rollout_ref.actor.kl_loss_coef=0.0 actor_rollout_ref.actor.entropy_coeff=0.0 actor_rollout_ref.model.enable_gradient_checkpointing=True actor_rollout_ref.actor.fsdp_config.param_offload=False actor_rollout_ref.actor.fsdp_config.optimizer_offload=False actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=80 actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=80 +actor_rollout_ref.ref.logr=True actor_rollout_ref.rollout.tensor_model_parallel_size=1 actor_rollout_ref.rollout.name=sglang actor_rollout_ref.rollout.gpu_memory_utilization=0.8 actor_rollout_ref.rollout.n=5 actor_rollout_ref.rollout.temperature=1.0 +actor_rollout_ref.rollout.per_turn_response_length=16 +actor_rollout_ref.rollout.max_code_lines=32 actor_rollout_ref.rollout.response_length=1024 algorithm.use_kl_in_reward=False trainer.critic_warmup=0 'trainer.logger=["console","wandb"]' trainer.project_name=em-correct trainer.experiment_name=80-200-olmo-nowarmup-nopenalty-log-nolenpenalty trainer.n_gpus_per_node=8 trainer.nnodes=1 trainer.val_before_train=False trainer.save_freq=200 trainer.test_freq=-1 trainer.total_epochs=1 +trainer.q_steps=80 +trainer.ref_update_freq=200 data.train_files=/mnt/task_runtime/opencoder_post.parquet data.val_files=/root/data/real_code/test.parquet actor_rollout_ref.rollout.multi_turn.interaction_config_path=/mnt/task_runtime/verl/examples/sglang_multiturn/config/interaction_config/gsm8k_interaction_config.yaml actor_rollout_ref.rollout.multi_turn.max_user_turns=1
2025-08-24 09:29:07,929	INFO worker.py:1918 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=3352229)[0m TaskRunner hostname: bolt-8xfg93i4zr-6csgcu35ry, PID: 3352229
[36m(TaskRunner pid=3352229)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'load_contents': ['hf_model',
[36m(TaskRunner pid=3352229)[0m                                                                   'model',
[36m(TaskRunner pid=3352229)[0m                                                                   'optimizer',
[36m(TaskRunner pid=3352229)[0m                                                                   'extra'],
[36m(TaskRunner pid=3352229)[0m                                                 'save_contents': ['hf_model',
[36m(TaskRunner pid=3352229)[0m                                                                   'model',
[36m(TaskRunner pid=3352229)[0m                                                                   'optimizer',
[36m(TaskRunner pid=3352229)[0m                                                                   'extra']},
[36m(TaskRunner pid=3352229)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=3352229)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=3352229)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=3352229)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=3352229)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=3352229)[0m                                  'entropy_coeff': 0.0,
[36m(TaskRunner pid=3352229)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=3352229)[0m                                  'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3352229)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=3352229)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=3352229)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=3352229)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=3352229)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=3352229)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3352229)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=3352229)[0m                                  'kl_loss_coef': 0.0,
[36m(TaskRunner pid=3352229)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=3352229)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=3352229)[0m                                  'ntp_coeff': 1.0,
[36m(TaskRunner pid=3352229)[0m                                  'ntp_micro_batch_size_per_gpu': 64,
[36m(TaskRunner pid=3352229)[0m                                  'ntp_mini_batch_size': 512,
[36m(TaskRunner pid=3352229)[0m                                  'optim': {'lr': 2e-06,
[36m(TaskRunner pid=3352229)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=3352229)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3352229)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=3352229)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=3352229)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=3352229)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=3352229)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=3352229)[0m                                  'policy_loss': {'clip_cov_lb': 1.0,
[36m(TaskRunner pid=3352229)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=3352229)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=3352229)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=3352229)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=3352229)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=3352229)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=3352229)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=3352229)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3352229)[0m                                  'ppo_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=3352229)[0m                                  'ppo_mini_batch_size': 256,
[36m(TaskRunner pid=3352229)[0m                                  'shuffle': False,
[36m(TaskRunner pid=3352229)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=3352229)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3352229)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=3352229)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=3352229)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=3352229)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=3352229)[0m                        'model': {'custom_chat_template': None,
[36m(TaskRunner pid=3352229)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=3352229)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3352229)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=3352229)[0m                                  'external_lib': None,
[36m(TaskRunner pid=3352229)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=3352229)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=3352229)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=3352229)[0m                                  'override_config': {},
[36m(TaskRunner pid=3352229)[0m                                  'path': '/root/.cache/huggingface/hub/models--allenai--OLMo-2-0425-1B/snapshots/a1847dff35000b4271fa70afc5db10fd29fedbdf',
[36m(TaskRunner pid=3352229)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=3352229)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=3352229)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=3352229)[0m                                  'use_liger': False,
[36m(TaskRunner pid=3352229)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=3352229)[0m                                  'use_shm': False},
[36m(TaskRunner pid=3352229)[0m                        'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3352229)[0m                                     'all_ranks': False,
[36m(TaskRunner pid=3352229)[0m                                     'discrete': False,
[36m(TaskRunner pid=3352229)[0m                                     'ranks': []},
[36m(TaskRunner pid=3352229)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=3352229)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=3352229)[0m                                'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3352229)[0m                                                'param_offload': False,
[36m(TaskRunner pid=3352229)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=3352229)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3352229)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=3352229)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3352229)[0m                                'log_prob_micro_batch_size_per_gpu': 80,
[36m(TaskRunner pid=3352229)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=3352229)[0m                                'logr': True,
[36m(TaskRunner pid=3352229)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=3352229)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3352229)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=3352229)[0m                        'rollout': {'agent': {'agent_loop_config_path': None,
[36m(TaskRunner pid=3352229)[0m                                              'custom_async_server': {'name': None,
[36m(TaskRunner pid=3352229)[0m                                                                      'path': None},
[36m(TaskRunner pid=3352229)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=3352229)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=3352229)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=3352229)[0m                                    'do_sample': True,
[36m(TaskRunner pid=3352229)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=3352229)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=3352229)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=3352229)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=3352229)[0m                                                      'vllm': {'disable_mm_preprocessor_cache': False,
[36m(TaskRunner pid=3352229)[0m                                                               'swap_space': None}},
[36m(TaskRunner pid=3352229)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=3352229)[0m                                    'gpu_memory_utilization': 0.8,
[36m(TaskRunner pid=3352229)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=3352229)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=3352229)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=3352229)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=3352229)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3352229)[0m                                    'log_prob_micro_batch_size_per_gpu': 80,
[36m(TaskRunner pid=3352229)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=3352229)[0m                                    'max_code_lines': 32,
[36m(TaskRunner pid=3352229)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=3352229)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=3352229)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=3352229)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=3352229)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=3352229)[0m                                    'multi_turn': {'completion_callback': None,
[36m(TaskRunner pid=3352229)[0m                                                   'enable': True,
[36m(TaskRunner pid=3352229)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=3352229)[0m                                                   'interaction_config_path': '/mnt/task_runtime/verl/examples/sglang_multiturn/config/interaction_config/gsm8k_interaction_config.yaml',
[36m(TaskRunner pid=3352229)[0m                                                   'max_assistant_turns': 100000,
[36m(TaskRunner pid=3352229)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=3352229)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=3352229)[0m                                                   'max_user_turns': 1,
[36m(TaskRunner pid=3352229)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=3352229)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=3352229)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=3352229)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=3352229)[0m                                    'n': 5,
[36m(TaskRunner pid=3352229)[0m                                    'name': 'sglang',
[36m(TaskRunner pid=3352229)[0m                                    'per_turn_response_length': 16,
[36m(TaskRunner pid=3352229)[0m                                    'prompt_length': 128,
[36m(TaskRunner pid=3352229)[0m                                    'response_length': 1024,
[36m(TaskRunner pid=3352229)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=3352229)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=3352229)[0m                                    'top_k': -1,
[36m(TaskRunner pid=3352229)[0m                                    'top_p': 1,
[36m(TaskRunner pid=3352229)[0m                                    'trace': {'backend': None,
[36m(TaskRunner pid=3352229)[0m                                              'token2text': False},
[36m(TaskRunner pid=3352229)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=3352229)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=3352229)[0m                                                   'n': 1,
[36m(TaskRunner pid=3352229)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=3352229)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=3352229)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=3352229)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=3352229)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=3352229)[0m                'gamma': 1.0,
[36m(TaskRunner pid=3352229)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=3352229)[0m                            'horizon': 10000,
[36m(TaskRunner pid=3352229)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=3352229)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=3352229)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=3352229)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=3352229)[0m                'lam': 1.0,
[36m(TaskRunner pid=3352229)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=3352229)[0m                'pf_ppo': {'_target_': 'verl.trainer.config.PFPPOConfig',
[36m(TaskRunner pid=3352229)[0m                           'reweight_method': 'pow',
[36m(TaskRunner pid=3352229)[0m                           'weight_pow': 2.0},
[36m(TaskRunner pid=3352229)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=3352229)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=3352229)[0m  'critic': {'_target_': 'verl.trainer.config.FSDPCriticConfig',
[36m(TaskRunner pid=3352229)[0m             'checkpoint': {'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=3352229)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=3352229)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=3352229)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3352229)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=3352229)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3352229)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=3352229)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=3352229)[0m             'model': {'enable_activation_offload': False,
[36m(TaskRunner pid=3352229)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3352229)[0m                       'external_lib': None,
[36m(TaskRunner pid=3352229)[0m                       'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3352229)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=3352229)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=3352229)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=3352229)[0m                                       'param_offload': False,
[36m(TaskRunner pid=3352229)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=3352229)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3352229)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=3352229)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=3352229)[0m                       'override_config': {},
[36m(TaskRunner pid=3352229)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=3352229)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=3352229)[0m                       'tokenizer_path': '/root/.cache/huggingface/hub/models--allenai--OLMo-2-0425-1B/snapshots/a1847dff35000b4271fa70afc5db10fd29fedbdf',
[36m(TaskRunner pid=3352229)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=3352229)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=3352229)[0m                       'use_shm': False},
[36m(TaskRunner pid=3352229)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=3352229)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3352229)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=3352229)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=3352229)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=3352229)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=3352229)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=3352229)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3352229)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3352229)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3352229)[0m             'ppo_mini_batch_size': 256,
[36m(TaskRunner pid=3352229)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3352229)[0m                          'all_ranks': False,
[36m(TaskRunner pid=3352229)[0m                          'discrete': False,
[36m(TaskRunner pid=3352229)[0m                          'ranks': []},
[36m(TaskRunner pid=3352229)[0m             'rollout_n': 5,
[36m(TaskRunner pid=3352229)[0m             'shuffle': False,
[36m(TaskRunner pid=3352229)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=3352229)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3352229)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=3352229)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=3352229)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=3352229)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=3352229)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=3352229)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=3352229)[0m           'filter_overlong_prompts_workers': 40,
[36m(TaskRunner pid=3352229)[0m           'image_key': 'images',
[36m(TaskRunner pid=3352229)[0m           'max_prompt_length': 128,
[36m(TaskRunner pid=3352229)[0m           'max_response_length': 1024,
[36m(TaskRunner pid=3352229)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=3352229)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=3352229)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=3352229)[0m           'return_raw_chat': True,
[36m(TaskRunner pid=3352229)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=3352229)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=3352229)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=3352229)[0m           'shuffle': True,
[36m(TaskRunner pid=3352229)[0m           'tokenizer': None,
[36m(TaskRunner pid=3352229)[0m           'train_batch_size': 1024,
[36m(TaskRunner pid=3352229)[0m           'train_files': '/mnt/task_runtime/opencoder_post.parquet',
[36m(TaskRunner pid=3352229)[0m           'truncation': 'error',
[36m(TaskRunner pid=3352229)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=3352229)[0m           'use_shm': False,
[36m(TaskRunner pid=3352229)[0m           'val_batch_size': None,
[36m(TaskRunner pid=3352229)[0m           'val_files': '/root/data/real_code/test.parquet',
[36m(TaskRunner pid=3352229)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=3352229)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=3352229)[0m  'ray_init': {'num_cpus': None, 'timeline_json_file': None},
[36m(TaskRunner pid=3352229)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=3352229)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3352229)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=3352229)[0m                   'max_length': None,
[36m(TaskRunner pid=3352229)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=3352229)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3352229)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=3352229)[0m                             'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3352229)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=3352229)[0m                                             'param_offload': False,
[36m(TaskRunner pid=3352229)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=3352229)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3352229)[0m                             'input_tokenizer': '/root/.cache/huggingface/hub/models--allenai--OLMo-2-0425-1B/snapshots/a1847dff35000b4271fa70afc5db10fd29fedbdf',
[36m(TaskRunner pid=3352229)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=3352229)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=3352229)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=3352229)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=3352229)[0m                             'use_shm': False},
[36m(TaskRunner pid=3352229)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3352229)[0m                                'all_ranks': False,
[36m(TaskRunner pid=3352229)[0m                                'discrete': False,
[36m(TaskRunner pid=3352229)[0m                                'ranks': []},
[36m(TaskRunner pid=3352229)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=3352229)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=3352229)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=3352229)[0m                                      'url': None},
[36m(TaskRunner pid=3352229)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=3352229)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3352229)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=3352229)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=3352229)[0m              'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=3352229)[0m                                            'cuda-memory-usage': 'true',
[36m(TaskRunner pid=3352229)[0m                                            'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=3352229)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=3352229)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=3352229)[0m              'default_local_dir': '/mnt/task_wrapper/user_output/artifacts/checkpoints/em-correct/80-200-olmo-nowarmup-nopenalty-log-nolenpenalty',
[36m(TaskRunner pid=3352229)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=3352229)[0m              'device': 'cuda',
[36m(TaskRunner pid=3352229)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=3352229)[0m              'experiment_name': '80-200-olmo-nowarmup-nopenalty-log-nolenpenalty',
[36m(TaskRunner pid=3352229)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=3352229)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=3352229)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=3352229)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=3352229)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=3352229)[0m              'nnodes': 1,
[36m(TaskRunner pid=3352229)[0m              'npu_profile': {'options': {'analysis': True,
[36m(TaskRunner pid=3352229)[0m                                          'level': 'level1',
[36m(TaskRunner pid=3352229)[0m                                          'record_shapes': False,
[36m(TaskRunner pid=3352229)[0m                                          'save_path': './profiler_data',
[36m(TaskRunner pid=3352229)[0m                                          'with_cpu': True,
[36m(TaskRunner pid=3352229)[0m                                          'with_memory': False,
[36m(TaskRunner pid=3352229)[0m                                          'with_module': False,
[36m(TaskRunner pid=3352229)[0m                                          'with_npu': True,
[36m(TaskRunner pid=3352229)[0m                                          'with_stack': False}},
[36m(TaskRunner pid=3352229)[0m              'profile_steps': None,
[36m(TaskRunner pid=3352229)[0m              'project_name': 'em-correct',
[36m(TaskRunner pid=3352229)[0m              'q_steps': 80,
[36m(TaskRunner pid=3352229)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=3352229)[0m              'ref_update_freq': 200,
[36m(TaskRunner pid=3352229)[0m              'resume_from_path': None,
[36m(TaskRunner pid=3352229)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=3352229)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=3352229)[0m              'save_freq': 200,
[36m(TaskRunner pid=3352229)[0m              'test_freq': -1,
[36m(TaskRunner pid=3352229)[0m              'total_epochs': 1,
[36m(TaskRunner pid=3352229)[0m              'total_training_steps': None,
[36m(TaskRunner pid=3352229)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=3352229)[0m              'val_before_train': False,
[36m(TaskRunner pid=3352229)[0m              'val_only': False,
[36m(TaskRunner pid=3352229)[0m              'validation_data_dir': None,
[36m(TaskRunner pid=3352229)[0m              'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=3352229)[0m                                        'capture-range-end': None,
[36m(TaskRunner pid=3352229)[0m                                        'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=3352229)[0m                                        'cuda-memory-usage': 'true',
[36m(TaskRunner pid=3352229)[0m                                        'kill': 'none',
[36m(TaskRunner pid=3352229)[0m                                        'trace': 'cuda,nvtx,cublas,ucx'}}}
[36m(TaskRunner pid=3352229)[0m 2025-08-24 09:29:15.729897: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[36m(TaskRunner pid=3352229)[0m 2025-08-24 09:29:15.745056: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
[36m(TaskRunner pid=3352229)[0m 2025-08-24 09:29:15.760832: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
[36m(TaskRunner pid=3352229)[0m 2025-08-24 09:29:15.764619: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[36m(TaskRunner pid=3352229)[0m 2025-08-24 09:29:15.774854: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[36m(TaskRunner pid=3352229)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX512_FP16 AVX_VNNI AMX_TILE AMX_INT8 AMX_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[36m(TaskRunner pid=3352229)[0m 2025-08-24 09:29:16.646246: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[36m(TaskRunner pid=3352229)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=3352229)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=3352229)[0m WARNING:2025-08-24 09:29:20,393:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   0%|          | 0/1914690 [00:00<?, ? examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   0%|          | 1000/1914690 [00:01<34:57, 912.58 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   0%|          | 3000/1914690 [00:01<10:38, 2992.44 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   0%|          | 7000/1914690 [00:01<04:20, 7336.83 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   1%|          | 12000/1914690 [00:01<02:18, 13724.32 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   1%|          | 16000/1914690 [00:01<01:43, 18352.79 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   1%|          | 23000/1914690 [00:01<01:11, 26494.36 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   2%|▏         | 29000/1914690 [00:01<00:56, 33201.18 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   2%|▏         | 37000/1914690 [00:01<00:42, 43807.12 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   2%|▏         | 43000/1914690 [00:02<00:39, 47133.71 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   3%|▎         | 53000/1914690 [00:02<00:33, 55763.12 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   3%|▎         | 65000/1914690 [00:02<00:26, 70601.88 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   4%|▍         | 76000/1914690 [00:02<00:23, 79308.23 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   4%|▍         | 86000/1914690 [00:02<00:23, 77415.05 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   5%|▌         | 105000/1914690 [00:02<00:17, 104207.70 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   6%|▌         | 116000/1914690 [00:02<00:19, 91776.91 examples/s] 
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   7%|▋         | 140000/1914690 [00:02<00:14, 122532.30 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   8%|▊         | 153000/1914690 [00:03<00:15, 111478.13 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):   9%|▉         | 174000/1914690 [00:03<00:12, 134121.55 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  10%|█         | 192000/1914690 [00:03<00:11, 143913.64 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  11%|█         | 208000/1914690 [00:03<00:12, 132564.22 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  12%|█▏        | 234000/1914690 [00:03<00:10, 162186.22 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  13%|█▎        | 252000/1914690 [00:03<00:10, 164882.40 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  14%|█▍        | 273000/1914690 [00:03<00:09, 176192.99 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  15%|█▌        | 292000/1914690 [00:03<00:09, 163204.01 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  17%|█▋        | 321000/1914690 [00:03<00:08, 191293.93 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  18%|█▊        | 343000/1914690 [00:04<00:07, 198550.85 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  19%|█▉        | 369000/1914690 [00:04<00:07, 215552.29 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  20%|██        | 392000/1914690 [00:04<00:07, 208943.37 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  22%|██▏       | 417000/1914690 [00:04<00:07, 213934.63 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  23%|██▎       | 444000/1914690 [00:04<00:06, 220228.52 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  24%|██▍       | 467000/1914690 [00:04<00:06, 219270.65 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  26%|██▌       | 496000/1914690 [00:04<00:06, 236438.68 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  27%|██▋       | 520000/1914690 [00:04<00:06, 225897.74 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  29%|██▊       | 549000/1914690 [00:04<00:05, 235390.46 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  30%|██▉       | 573000/1914690 [00:05<00:05, 225147.92 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  31%|███       | 598000/1914690 [00:05<00:05, 229060.42 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  32%|███▏      | 622000/1914690 [00:05<00:05, 231787.36 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  34%|███▎      | 646000/1914690 [00:05<00:05, 227315.02 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  35%|███▌      | 672000/1914690 [00:05<00:05, 235522.75 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  36%|███▋      | 696000/1914690 [00:05<00:05, 222051.90 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  38%|███▊      | 719000/1914690 [00:05<00:05, 222897.17 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  39%|███▉      | 743000/1914690 [00:05<00:05, 222677.99 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  40%|████      | 767000/1914690 [00:05<00:05, 225710.72 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  41%|████▏     | 793000/1914690 [00:06<00:04, 235508.72 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  43%|████▎     | 817000/1914690 [00:06<00:04, 235868.79 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  44%|████▍     | 841000/1914690 [00:06<00:04, 228123.00 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  45%|████▌     | 868000/1914690 [00:06<00:04, 239268.97 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  47%|████▋     | 894000/1914690 [00:06<00:04, 243050.58 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  48%|████▊     | 919000/1914690 [00:06<00:04, 231038.12 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  49%|████▉     | 946000/1914690 [00:06<00:04, 237744.23 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  51%|█████     | 970000/1914690 [00:06<00:04, 234685.30 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  52%|█████▏    | 994000/1914690 [00:06<00:03, 234478.34 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  53%|█████▎    | 1024000/1914690 [00:07<00:03, 227981.06 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  55%|█████▌    | 1055000/1914690 [00:07<00:03, 248795.17 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  56%|█████▋    | 1081000/1914690 [00:07<00:03, 239282.59 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  58%|█████▊    | 1106000/1914690 [00:07<00:03, 232253.96 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  59%|█████▉    | 1133000/1914690 [00:07<00:03, 239781.55 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  60%|██████    | 1158000/1914690 [00:07<00:03, 242438.55 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  62%|██████▏   | 1183000/1914690 [00:07<00:03, 232343.62 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  63%|██████▎   | 1209000/1914690 [00:07<00:02, 239890.73 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  64%|██████▍   | 1234000/1914690 [00:07<00:02, 234106.93 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  66%|██████▌   | 1259000/1914690 [00:08<00:02, 233623.15 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  67%|██████▋   | 1285000/1914690 [00:08<00:02, 240721.47 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  68%|██████▊   | 1310000/1914690 [00:08<00:02, 242314.70 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  70%|██████▉   | 1335000/1914690 [00:08<00:02, 231765.48 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  71%|███████   | 1362000/1914690 [00:08<00:02, 240769.91 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  72%|███████▏  | 1387000/1914690 [00:08<00:02, 243275.69 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  74%|███████▎  | 1412000/1914690 [00:08<00:02, 231731.24 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  75%|███████▌  | 1438000/1914690 [00:08<00:02, 229976.59 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  77%|███████▋  | 1467868/1914690 [00:08<00:01, 247477.36 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  78%|███████▊  | 1493736/1914690 [00:09<00:01, 238224.45 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  79%|███████▉  | 1518736/1914690 [00:09<00:01, 230887.10 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  81%|████████  | 1544472/1914690 [00:09<00:01, 231827.31 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  82%|████████▏ | 1568208/1914690 [00:09<00:01, 225438.27 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  83%|████████▎ | 1591208/1914690 [00:09<00:01, 216542.74 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  84%|████████▍ | 1614076/1914690 [00:09<00:01, 209770.77 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  85%|████████▌ | 1635811/1914690 [00:09<00:01, 209911.89 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  87%|████████▋ | 1657280/1914690 [00:09<00:01, 205593.99 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  88%|████████▊ | 1678280/1914690 [00:09<00:01, 189991.43 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  89%|████████▊ | 1698280/1914690 [00:10<00:01, 182703.52 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  90%|████████▉ | 1717280/1914690 [00:10<00:01, 178549.13 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  91%|█████████ | 1736014/1914690 [00:10<00:01, 178235.57 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  92%|█████████▏| 1754749/1914690 [00:10<00:00, 165164.61 examples/s]
[36m(TaskRunner pid=3352229)[0m Filter (num_proc=40):  93%|█████████▎| 1771749/1914690 [00:10<00:00, 161876.05 examples/s]
*** SIGTERM received at time=1756027771 on cpu 29 ***
PC: @     0x7831c2526117  (unknown)  (unknown)
    @     0x7831c24d7520  (unknown)  (unknown)
    @ ... and at least 1 more frames
[2025-08-24 09:29:31,129 E 3339232 3339232] logging.cc:501: *** SIGTERM received at time=1756027771 on cpu 29 ***
[2025-08-24 09:29:31,129 E 3339232 3339232] logging.cc:501: PC: @     0x7831c2526117  (unknown)  (unknown)
[2025-08-24 09:29:31,129 E 3339232 3339232] logging.cc:501:     @     0x7831c24d7520  (unknown)  (unknown)
[2025-08-24 09:29:31,129 E 3339232 3339232] logging.cc:501:     @ ... and at least 1 more frames
+ export HYDRA_FULL_ERROR=1
+ HYDRA_FULL_ERROR=1
+ ulimit -n 65535
++ pwd
+ PROJECT_DIR=/mnt/task_runtime/verl
+ CONFIG_PATH=/mnt/task_runtime/verl/examples/sglang_multiturn/config
+ python3 -m verl.trainer.main_ppo --config-path=/mnt/task_runtime/verl/examples/sglang_multiturn/config --config-name=gsm8k_multiturn_grpo algorithm.adv_estimator=grpo data.train_batch_size=1024 data.max_prompt_length=128 data.filter_overlong_prompts=True data.truncation=error data.return_raw_chat=True data.filter_overlong_prompts_workers=40 actor_rollout_ref.model.path=/root/.cache/huggingface/hub/models--allenai--OLMo-2-0425-1B/snapshots/a1847dff35000b4271fa70afc5db10fd29fedbdf +actor_rollout_ref.actor.ntp_coeff=1.0 actor_rollout_ref.actor.optim.lr=2e-6 actor_rollout_ref.model.use_remove_padding=True actor_rollout_ref.actor.ppo_mini_batch_size=256 +actor_rollout_ref.actor.ntp_mini_batch_size=512 actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=32 +actor_rollout_ref.actor.ntp_micro_batch_size_per_gpu=64 actor_rollout_ref.actor.use_kl_loss=False actor_rollout_ref.actor.kl_loss_coef=0.0 actor_rollout_ref.actor.entropy_coeff=0.0 actor_rollout_ref.model.enable_gradient_checkpointing=True actor_rollout_ref.actor.fsdp_config.param_offload=False actor_rollout_ref.actor.fsdp_config.optimizer_offload=False actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=80 actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=80 +actor_rollout_ref.ref.logr=True actor_rollout_ref.rollout.tensor_model_parallel_size=1 actor_rollout_ref.rollout.name=sglang actor_rollout_ref.rollout.gpu_memory_utilization=0.8 actor_rollout_ref.rollout.n=5 actor_rollout_ref.rollout.temperature=1.0 +actor_rollout_ref.rollout.per_turn_response_length=16 +actor_rollout_ref.rollout.max_code_lines=32 actor_rollout_ref.rollout.response_length=1024 algorithm.use_kl_in_reward=False trainer.critic_warmup=0 'trainer.logger=["console","wandb"]' trainer.project_name=em-correct trainer.experiment_name=80-200-olmo-nowarmup-nopenalty-log-nolenpenalty trainer.n_gpus_per_node=8 trainer.nnodes=1 trainer.val_before_train=False trainer.save_freq=200 trainer.test_freq=-1 trainer.total_epochs=1 +trainer.q_steps=80 +trainer.ref_update_freq=200 data.train_files=/mnt/task_runtime/opencoder_post.parquet data.val_files=/root/data/real_code/test.parquet actor_rollout_ref.rollout.multi_turn.interaction_config_path=/mnt/task_runtime/verl/examples/sglang_multiturn/config/interaction_config/gsm8k_interaction_config.yaml actor_rollout_ref.rollout.multi_turn.max_user_turns=1
2025-08-24 09:30:37,395	INFO worker.py:1918 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=3376910)[0m TaskRunner hostname: bolt-8xfg93i4zr-6csgcu35ry, PID: 3376910
[36m(TaskRunner pid=3376910)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'load_contents': ['hf_model',
[36m(TaskRunner pid=3376910)[0m                                                                   'model',
[36m(TaskRunner pid=3376910)[0m                                                                   'optimizer',
[36m(TaskRunner pid=3376910)[0m                                                                   'extra'],
[36m(TaskRunner pid=3376910)[0m                                                 'save_contents': ['hf_model',
[36m(TaskRunner pid=3376910)[0m                                                                   'model',
[36m(TaskRunner pid=3376910)[0m                                                                   'optimizer',
[36m(TaskRunner pid=3376910)[0m                                                                   'extra']},
[36m(TaskRunner pid=3376910)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=3376910)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=3376910)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=3376910)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=3376910)[0m                                  'entropy_checkpointing': False,
[36m(TaskRunner pid=3376910)[0m                                  'entropy_coeff': 0.0,
[36m(TaskRunner pid=3376910)[0m                                  'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=3376910)[0m                                  'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3376910)[0m                                                  'fsdp_size': -1,
[36m(TaskRunner pid=3376910)[0m                                                  'offload_policy': False,
[36m(TaskRunner pid=3376910)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=3376910)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=3376910)[0m                                                  'reshard_after_forward': True,
[36m(TaskRunner pid=3376910)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3376910)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=3376910)[0m                                  'kl_loss_coef': 0.0,
[36m(TaskRunner pid=3376910)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=3376910)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=3376910)[0m                                  'ntp_coeff': 1.0,
[36m(TaskRunner pid=3376910)[0m                                  'ntp_micro_batch_size_per_gpu': 64,
[36m(TaskRunner pid=3376910)[0m                                  'ntp_mini_batch_size': 512,
[36m(TaskRunner pid=3376910)[0m                                  'optim': {'lr': 2e-06,
[36m(TaskRunner pid=3376910)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=3376910)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3376910)[0m                                            'min_lr_ratio': 0.0,
[36m(TaskRunner pid=3376910)[0m                                            'num_cycles': 0.5,
[36m(TaskRunner pid=3376910)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=3376910)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=3376910)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=3376910)[0m                                  'policy_loss': {'clip_cov_lb': 1.0,
[36m(TaskRunner pid=3376910)[0m                                                  'clip_cov_ratio': 0.0002,
[36m(TaskRunner pid=3376910)[0m                                                  'clip_cov_ub': 5.0,
[36m(TaskRunner pid=3376910)[0m                                                  'kl_cov_ratio': 0.0002,
[36m(TaskRunner pid=3376910)[0m                                                  'loss_mode': 'vanilla',
[36m(TaskRunner pid=3376910)[0m                                                  'ppo_kl_coef': 0.1},
[36m(TaskRunner pid=3376910)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=3376910)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=3376910)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3376910)[0m                                  'ppo_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=3376910)[0m                                  'ppo_mini_batch_size': 256,
[36m(TaskRunner pid=3376910)[0m                                  'shuffle': False,
[36m(TaskRunner pid=3376910)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=3376910)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3376910)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=3376910)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=3376910)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=3376910)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=3376910)[0m                        'model': {'custom_chat_template': None,
[36m(TaskRunner pid=3376910)[0m                                  'enable_activation_offload': False,
[36m(TaskRunner pid=3376910)[0m                                  'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3376910)[0m                                  'exclude_modules': None,
[36m(TaskRunner pid=3376910)[0m                                  'external_lib': None,
[36m(TaskRunner pid=3376910)[0m                                  'fused_kernel_options': {'impl_backend': 'torch'},
[36m(TaskRunner pid=3376910)[0m                                  'lora_alpha': 16,
[36m(TaskRunner pid=3376910)[0m                                  'lora_rank': 0,
[36m(TaskRunner pid=3376910)[0m                                  'override_config': {},
[36m(TaskRunner pid=3376910)[0m                                  'path': '/root/.cache/huggingface/hub/models--allenai--OLMo-2-0425-1B/snapshots/a1847dff35000b4271fa70afc5db10fd29fedbdf',
[36m(TaskRunner pid=3376910)[0m                                  'target_modules': 'all-linear',
[36m(TaskRunner pid=3376910)[0m                                  'trust_remote_code': False,
[36m(TaskRunner pid=3376910)[0m                                  'use_fused_kernels': False,
[36m(TaskRunner pid=3376910)[0m                                  'use_liger': False,
[36m(TaskRunner pid=3376910)[0m                                  'use_remove_padding': True,
[36m(TaskRunner pid=3376910)[0m                                  'use_shm': False},
[36m(TaskRunner pid=3376910)[0m                        'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3376910)[0m                                     'all_ranks': False,
[36m(TaskRunner pid=3376910)[0m                                     'discrete': False,
[36m(TaskRunner pid=3376910)[0m                                     'ranks': []},
[36m(TaskRunner pid=3376910)[0m                        'ref': {'entropy_checkpointing': False,
[36m(TaskRunner pid=3376910)[0m                                'entropy_from_logits_with_chunking': False,
[36m(TaskRunner pid=3376910)[0m                                'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3376910)[0m                                                'param_offload': False,
[36m(TaskRunner pid=3376910)[0m                                                'reshard_after_forward': True,
[36m(TaskRunner pid=3376910)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3376910)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=3376910)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3376910)[0m                                'log_prob_micro_batch_size_per_gpu': 80,
[36m(TaskRunner pid=3376910)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=3376910)[0m                                'logr': True,
[36m(TaskRunner pid=3376910)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=3376910)[0m                                'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3376910)[0m                                'use_torch_compile': True},
[36m(TaskRunner pid=3376910)[0m                        'rollout': {'agent': {'agent_loop_config_path': None,
[36m(TaskRunner pid=3376910)[0m                                              'custom_async_server': {'name': None,
[36m(TaskRunner pid=3376910)[0m                                                                      'path': None},
[36m(TaskRunner pid=3376910)[0m                                              'num_workers': 8},
[36m(TaskRunner pid=3376910)[0m                                    'calculate_log_probs': False,
[36m(TaskRunner pid=3376910)[0m                                    'disable_log_stats': True,
[36m(TaskRunner pid=3376910)[0m                                    'do_sample': True,
[36m(TaskRunner pid=3376910)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=3376910)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=3376910)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=3376910)[0m                                    'engine_kwargs': {'sglang': {'attention_backend': None},
[36m(TaskRunner pid=3376910)[0m                                                      'vllm': {'disable_mm_preprocessor_cache': False,
[36m(TaskRunner pid=3376910)[0m                                                               'swap_space': None}},
[36m(TaskRunner pid=3376910)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=3376910)[0m                                    'gpu_memory_utilization': 0.8,
[36m(TaskRunner pid=3376910)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=3376910)[0m                                    'layered_summon': False,
[36m(TaskRunner pid=3376910)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=3376910)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=3376910)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3376910)[0m                                    'log_prob_micro_batch_size_per_gpu': 80,
[36m(TaskRunner pid=3376910)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=3376910)[0m                                    'max_code_lines': 32,
[36m(TaskRunner pid=3376910)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=3376910)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=3376910)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=3376910)[0m                                    'mode': 'sync',
[36m(TaskRunner pid=3376910)[0m                                    'multi_stage_wake_up': False,
[36m(TaskRunner pid=3376910)[0m                                    'multi_turn': {'completion_callback': None,
[36m(TaskRunner pid=3376910)[0m                                                   'enable': True,
[36m(TaskRunner pid=3376910)[0m                                                   'format': 'hermes',
[36m(TaskRunner pid=3376910)[0m                                                   'interaction_config_path': '/mnt/task_runtime/verl/examples/sglang_multiturn/config/interaction_config/gsm8k_interaction_config.yaml',
[36m(TaskRunner pid=3376910)[0m                                                   'max_assistant_turns': 100000,
[36m(TaskRunner pid=3376910)[0m                                                   'max_parallel_calls': 1,
[36m(TaskRunner pid=3376910)[0m                                                   'max_tool_response_length': 256,
[36m(TaskRunner pid=3376910)[0m                                                   'max_user_turns': 1,
[36m(TaskRunner pid=3376910)[0m                                                   'tokenization_sanity_check_mode': 'strict',
[36m(TaskRunner pid=3376910)[0m                                                   'tool_config_path': None,
[36m(TaskRunner pid=3376910)[0m                                                   'tool_response_truncate_side': 'middle',
[36m(TaskRunner pid=3376910)[0m                                                   'use_inference_chat_template': False},
[36m(TaskRunner pid=3376910)[0m                                    'n': 5,
[36m(TaskRunner pid=3376910)[0m                                    'name': 'sglang',
[36m(TaskRunner pid=3376910)[0m                                    'per_turn_response_length': 16,
[36m(TaskRunner pid=3376910)[0m                                    'prompt_length': 128,
[36m(TaskRunner pid=3376910)[0m                                    'response_length': 1024,
[36m(TaskRunner pid=3376910)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=3376910)[0m                                    'tensor_model_parallel_size': 1,
[36m(TaskRunner pid=3376910)[0m                                    'top_k': -1,
[36m(TaskRunner pid=3376910)[0m                                    'top_p': 1,
[36m(TaskRunner pid=3376910)[0m                                    'trace': {'backend': None,
[36m(TaskRunner pid=3376910)[0m                                              'token2text': False},
[36m(TaskRunner pid=3376910)[0m                                    'update_weights_bucket_megabytes': 512,
[36m(TaskRunner pid=3376910)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=3376910)[0m                                                   'n': 1,
[36m(TaskRunner pid=3376910)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=3376910)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=3376910)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=3376910)[0m  'algorithm': {'_target_': 'verl.trainer.config.AlgoConfig',
[36m(TaskRunner pid=3376910)[0m                'adv_estimator': 'grpo',
[36m(TaskRunner pid=3376910)[0m                'gamma': 1.0,
[36m(TaskRunner pid=3376910)[0m                'kl_ctrl': {'_target_': 'verl.trainer.config.KLControlConfig',
[36m(TaskRunner pid=3376910)[0m                            'horizon': 10000,
[36m(TaskRunner pid=3376910)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=3376910)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=3376910)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=3376910)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=3376910)[0m                'lam': 1.0,
[36m(TaskRunner pid=3376910)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=3376910)[0m                'pf_ppo': {'_target_': 'verl.trainer.config.PFPPOConfig',
[36m(TaskRunner pid=3376910)[0m                           'reweight_method': 'pow',
[36m(TaskRunner pid=3376910)[0m                           'weight_pow': 2.0},
[36m(TaskRunner pid=3376910)[0m                'use_kl_in_reward': False,
[36m(TaskRunner pid=3376910)[0m                'use_pf_ppo': False},
[36m(TaskRunner pid=3376910)[0m  'critic': {'_target_': 'verl.trainer.config.FSDPCriticConfig',
[36m(TaskRunner pid=3376910)[0m             'checkpoint': {'load_contents': ['model', 'optimizer', 'extra'],
[36m(TaskRunner pid=3376910)[0m                            'save_contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=3376910)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=3376910)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3376910)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=3376910)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3376910)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=3376910)[0m             'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=3376910)[0m             'model': {'enable_activation_offload': False,
[36m(TaskRunner pid=3376910)[0m                       'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3376910)[0m                       'external_lib': None,
[36m(TaskRunner pid=3376910)[0m                       'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3376910)[0m                                       'fsdp_size': -1,
[36m(TaskRunner pid=3376910)[0m                                       'offload_policy': False,
[36m(TaskRunner pid=3376910)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=3376910)[0m                                       'param_offload': False,
[36m(TaskRunner pid=3376910)[0m                                       'reshard_after_forward': True,
[36m(TaskRunner pid=3376910)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3376910)[0m                       'lora_alpha': 16,
[36m(TaskRunner pid=3376910)[0m                       'lora_rank': 0,
[36m(TaskRunner pid=3376910)[0m                       'override_config': {},
[36m(TaskRunner pid=3376910)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=3376910)[0m                       'target_modules': 'all-linear',
[36m(TaskRunner pid=3376910)[0m                       'tokenizer_path': '/root/.cache/huggingface/hub/models--allenai--OLMo-2-0425-1B/snapshots/a1847dff35000b4271fa70afc5db10fd29fedbdf',
[36m(TaskRunner pid=3376910)[0m                       'trust_remote_code': False,
[36m(TaskRunner pid=3376910)[0m                       'use_remove_padding': False,
[36m(TaskRunner pid=3376910)[0m                       'use_shm': False},
[36m(TaskRunner pid=3376910)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=3376910)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3376910)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=3376910)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=3376910)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=3376910)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=3376910)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=3376910)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3376910)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3376910)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3376910)[0m             'ppo_mini_batch_size': 256,
[36m(TaskRunner pid=3376910)[0m             'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3376910)[0m                          'all_ranks': False,
[36m(TaskRunner pid=3376910)[0m                          'discrete': False,
[36m(TaskRunner pid=3376910)[0m                          'ranks': []},
[36m(TaskRunner pid=3376910)[0m             'rollout_n': 5,
[36m(TaskRunner pid=3376910)[0m             'shuffle': False,
[36m(TaskRunner pid=3376910)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=3376910)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3376910)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=3376910)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=3376910)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=3376910)[0m           'datagen': {'name': None, 'path': None},
[36m(TaskRunner pid=3376910)[0m           'dataloader_num_workers': 8,
[36m(TaskRunner pid=3376910)[0m           'filter_overlong_prompts': True,
[36m(TaskRunner pid=3376910)[0m           'filter_overlong_prompts_workers': 40,
[36m(TaskRunner pid=3376910)[0m           'image_key': 'images',
[36m(TaskRunner pid=3376910)[0m           'max_prompt_length': 128,
[36m(TaskRunner pid=3376910)[0m           'max_response_length': 1024,
[36m(TaskRunner pid=3376910)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=3376910)[0m           'return_full_prompt': False,
[36m(TaskRunner pid=3376910)[0m           'return_multi_modal_inputs': True,
[36m(TaskRunner pid=3376910)[0m           'return_raw_chat': True,
[36m(TaskRunner pid=3376910)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=3376910)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=3376910)[0m           'sampler': {'class_name': None, 'class_path': None},
[36m(TaskRunner pid=3376910)[0m           'shuffle': True,
[36m(TaskRunner pid=3376910)[0m           'tokenizer': None,
[36m(TaskRunner pid=3376910)[0m           'train_batch_size': 1024,
[36m(TaskRunner pid=3376910)[0m           'train_files': '/mnt/task_runtime/opencoder_post.parquet',
[36m(TaskRunner pid=3376910)[0m           'truncation': 'error',
[36m(TaskRunner pid=3376910)[0m           'trust_remote_code': False,
[36m(TaskRunner pid=3376910)[0m           'use_shm': False,
[36m(TaskRunner pid=3376910)[0m           'val_batch_size': None,
[36m(TaskRunner pid=3376910)[0m           'val_files': '/root/data/real_code/test.parquet',
[36m(TaskRunner pid=3376910)[0m           'validation_shuffle': False,
[36m(TaskRunner pid=3376910)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=3376910)[0m  'ray_init': {'num_cpus': None, 'timeline_json_file': None},
[36m(TaskRunner pid=3376910)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=3376910)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3376910)[0m                   'launch_reward_fn_async': False,
[36m(TaskRunner pid=3376910)[0m                   'max_length': None,
[36m(TaskRunner pid=3376910)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=3376910)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3376910)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=3376910)[0m                             'fsdp_config': {'forward_prefetch': False,
[36m(TaskRunner pid=3376910)[0m                                             'fsdp_size': -1,
[36m(TaskRunner pid=3376910)[0m                                             'param_offload': False,
[36m(TaskRunner pid=3376910)[0m                                             'reshard_after_forward': True,
[36m(TaskRunner pid=3376910)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3376910)[0m                             'input_tokenizer': '/root/.cache/huggingface/hub/models--allenai--OLMo-2-0425-1B/snapshots/a1847dff35000b4271fa70afc5db10fd29fedbdf',
[36m(TaskRunner pid=3376910)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=3376910)[0m                             'trust_remote_code': False,
[36m(TaskRunner pid=3376910)[0m                             'use_fused_kernels': False,
[36m(TaskRunner pid=3376910)[0m                             'use_remove_padding': False,
[36m(TaskRunner pid=3376910)[0m                             'use_shm': False},
[36m(TaskRunner pid=3376910)[0m                   'profiler': {'_target_': 'verl.utils.profiler.ProfilerConfig',
[36m(TaskRunner pid=3376910)[0m                                'all_ranks': False,
[36m(TaskRunner pid=3376910)[0m                                'discrete': False,
[36m(TaskRunner pid=3376910)[0m                                'ranks': []},
[36m(TaskRunner pid=3376910)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=3376910)[0m                   'sandbox_fusion': {'max_concurrent': 64,
[36m(TaskRunner pid=3376910)[0m                                      'memory_limit_mb': 1024,
[36m(TaskRunner pid=3376910)[0m                                      'url': None},
[36m(TaskRunner pid=3376910)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=3376910)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3376910)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=3376910)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=3376910)[0m              'controller_nsight_options': {'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=3376910)[0m                                            'cuda-memory-usage': 'true',
[36m(TaskRunner pid=3376910)[0m                                            'trace': 'cuda,nvtx,cublas,ucx'},
[36m(TaskRunner pid=3376910)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=3376910)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=3376910)[0m              'default_local_dir': '/mnt/task_wrapper/user_output/artifacts/checkpoints/em-correct/80-200-olmo-nowarmup-nopenalty-log-nolenpenalty',
[36m(TaskRunner pid=3376910)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=3376910)[0m              'device': 'cuda',
[36m(TaskRunner pid=3376910)[0m              'esi_redundant_time': 0,
[36m(TaskRunner pid=3376910)[0m              'experiment_name': '80-200-olmo-nowarmup-nopenalty-log-nolenpenalty',
[36m(TaskRunner pid=3376910)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=3376910)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=3376910)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=3376910)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=3376910)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=3376910)[0m              'nnodes': 1,
[36m(TaskRunner pid=3376910)[0m              'npu_profile': {'options': {'analysis': True,
[36m(TaskRunner pid=3376910)[0m                                          'level': 'level1',
[36m(TaskRunner pid=3376910)[0m                                          'record_shapes': False,
[36m(TaskRunner pid=3376910)[0m                                          'save_path': './profiler_data',
[36m(TaskRunner pid=3376910)[0m                                          'with_cpu': True,
[36m(TaskRunner pid=3376910)[0m                                          'with_memory': False,
[36m(TaskRunner pid=3376910)[0m                                          'with_module': False,
[36m(TaskRunner pid=3376910)[0m                                          'with_npu': True,
[36m(TaskRunner pid=3376910)[0m                                          'with_stack': False}},
[36m(TaskRunner pid=3376910)[0m              'profile_steps': None,
[36m(TaskRunner pid=3376910)[0m              'project_name': 'em-correct',
[36m(TaskRunner pid=3376910)[0m              'q_steps': 80,
[36m(TaskRunner pid=3376910)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=3376910)[0m              'ref_update_freq': 200,
[36m(TaskRunner pid=3376910)[0m              'resume_from_path': None,
[36m(TaskRunner pid=3376910)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=3376910)[0m              'rollout_data_dir': None,
[36m(TaskRunner pid=3376910)[0m              'save_freq': 200,
[36m(TaskRunner pid=3376910)[0m              'test_freq': -1,
[36m(TaskRunner pid=3376910)[0m              'total_epochs': 1,
[36m(TaskRunner pid=3376910)[0m              'total_training_steps': None,
[36m(TaskRunner pid=3376910)[0m              'use_legacy_worker_impl': 'auto',
[36m(TaskRunner pid=3376910)[0m              'val_before_train': False,
[36m(TaskRunner pid=3376910)[0m              'val_only': False,
[36m(TaskRunner pid=3376910)[0m              'validation_data_dir': None,
[36m(TaskRunner pid=3376910)[0m              'worker_nsight_options': {'capture-range': 'cudaProfilerApi',
[36m(TaskRunner pid=3376910)[0m                                        'capture-range-end': None,
[36m(TaskRunner pid=3376910)[0m                                        'cuda-graph-trace': 'graph',
[36m(TaskRunner pid=3376910)[0m                                        'cuda-memory-usage': 'true',
[36m(TaskRunner pid=3376910)[0m                                        'kill': 'none',
[36m(TaskRunner pid=3376910)[0m                                        'trace': 'cuda,nvtx,cublas,ucx'}}}
[36m(TaskRunner pid=3376910)[0m 2025-08-24 09:30:45.238709: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[36m(TaskRunner pid=3376910)[0m 2025-08-24 09:30:45.253809: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
[36m(TaskRunner pid=3376910)[0m 2025-08-24 09:30:45.269506: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
[36m(TaskRunner pid=3376910)[0m 2025-08-24 09:30:45.273325: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[36m(TaskRunner pid=3376910)[0m 2025-08-24 09:30:45.283456: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[36m(TaskRunner pid=3376910)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX512_FP16 AVX_VNNI AMX_TILE AMX_INT8 AMX_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[36m(TaskRunner pid=3376910)[0m 2025-08-24 09:30:46.165265: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[36m(TaskRunner pid=3376910)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=3376910)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=3376910)[0m WARNING:2025-08-24 09:30:49,778:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   0%|          | 0/1914690 [00:00<?, ? examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   0%|          | 1000/1914690 [00:01<36:10, 881.84 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   0%|          | 4000/1914690 [00:01<08:19, 3828.91 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   0%|          | 9000/1914690 [00:01<03:32, 8968.36 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   1%|          | 16000/1914690 [00:01<01:57, 16117.68 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   1%|▏         | 25000/1914690 [00:01<01:09, 27324.77 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   2%|▏         | 30000/1914690 [00:01<01:00, 31204.09 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   2%|▏         | 37000/1914690 [00:02<00:52, 35789.42 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   3%|▎         | 49000/1914690 [00:02<00:36, 50967.40 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   3%|▎         | 56000/1914690 [00:02<00:36, 50955.56 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   4%|▎         | 71000/1914690 [00:02<00:26, 69895.15 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   4%|▍         | 85000/1914690 [00:02<00:23, 78429.44 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   5%|▌         | 102000/1914690 [00:02<00:18, 97916.84 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   6%|▌         | 113000/1914690 [00:02<00:20, 87990.53 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   7%|▋         | 133000/1914690 [00:02<00:15, 113108.47 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   8%|▊         | 147000/1914690 [00:03<00:14, 119558.13 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   8%|▊         | 162000/1914690 [00:03<00:15, 113244.85 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  10%|▉         | 187000/1914690 [00:03<00:11, 144665.82 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  11%|█         | 203000/1914690 [00:03<00:13, 128782.85 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  12%|█▏        | 229000/1914690 [00:03<00:10, 157982.89 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  13%|█▎        | 250000/1914690 [00:03<00:09, 169965.90 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  14%|█▍        | 268000/1914690 [00:03<00:10, 153616.35 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  15%|█▌        | 293000/1914690 [00:03<00:09, 175491.87 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  17%|█▋        | 318000/1914690 [00:03<00:08, 192677.80 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  18%|█▊        | 339000/1914690 [00:04<00:08, 194636.51 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  19%|█▉        | 360000/1914690 [00:04<00:08, 193362.47 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  20%|██        | 387000/1914690 [00:04<00:07, 212105.52 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  21%|██▏       | 410000/1914690 [00:04<00:06, 216151.20 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  23%|██▎       | 432000/1914690 [00:04<00:07, 210849.52 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  24%|██▍       | 459000/1914690 [00:04<00:06, 222152.23 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  25%|██▌       | 485000/1914690 [00:04<00:06, 230715.37 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  27%|██▋       | 509000/1914690 [00:04<00:06, 219339.36 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  28%|██▊       | 536000/1914690 [00:04<00:06, 226491.33 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  29%|██▉       | 559000/1914690 [00:05<00:06, 224148.10 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  31%|███       | 584000/1914690 [00:05<00:05, 226105.67 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  32%|███▏      | 607000/1914690 [00:05<00:05, 220184.11 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  33%|███▎      | 631000/1914690 [00:05<00:05, 225615.22 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  34%|███▍      | 654000/1914690 [00:05<00:05, 221407.28 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  35%|███▌      | 678000/1914690 [00:05<00:05, 224243.51 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  37%|███▋      | 701000/1914690 [00:05<00:05, 225349.51 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  38%|███▊      | 724000/1914690 [00:05<00:05, 222571.18 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  39%|███▉      | 751000/1914690 [00:05<00:05, 229258.15 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  40%|████      | 774000/1914690 [00:06<00:05, 220759.13 examples/s]Filter (num_proc=40):  42%|████▏     | 799000/1914690 [00:06<00:04, 228294.88 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  43%|████▎     | 825000/1914690 [00:06<00:04, 234547.35 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  44%|████▍     | 849000/1914690 [00:06<00:04, 231224.29 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  46%|████▌     | 873000/1914690 [00:06<00:04, 228386.60 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  47%|████▋     | 900000/1914690 [00:06<00:04, 238884.48 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  48%|████▊     | 924000/1914690 [00:06<00:04, 230645.35 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  50%|████▉     | 948000/1914690 [00:06<00:04, 229732.58 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  51%|█████     | 973000/1914690 [00:06<00:04, 232482.83 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  52%|█████▏    | 997000/1914690 [00:06<00:03, 233954.23 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  53%|█████▎    | 1021000/1914690 [00:07<00:03, 224266.35 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  55%|█████▍    | 1051000/1914690 [00:07<00:03, 241053.91 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  56%|█████▌    | 1076000/1914690 [00:07<00:03, 230087.01 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  57%|█████▋    | 1100000/1914690 [00:07<00:03, 224326.36 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  59%|█████▉    | 1130000/1914690 [00:07<00:03, 244410.39 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  60%|██████    | 1155000/1914690 [00:07<00:03, 236109.52 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  62%|██████▏   | 1179000/1914690 [00:07<00:03, 232037.85 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  63%|██████▎   | 1203000/1914690 [00:07<00:03, 234261.64 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  64%|██████▍   | 1228000/1914690 [00:07<00:02, 237277.75 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  65%|██████▌   | 1252000/1914690 [00:08<00:02, 233300.45 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  67%|██████▋   | 1276000/1914690 [00:08<00:02, 233766.46 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  68%|██████▊   | 1300000/1914690 [00:08<00:02, 234598.25 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  69%|██████▉   | 1325000/1914690 [00:08<00:02, 232581.16 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  71%|███████   | 1353000/1914690 [00:08<00:02, 243434.16 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  72%|███████▏  | 1378000/1914690 [00:08<00:02, 229264.60 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  73%|███████▎  | 1402000/1914690 [00:08<00:02, 224074.27 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  75%|███████▍  | 1433868/1914690 [00:08<00:01, 244849.39 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  76%|███████▌  | 1458868/1914690 [00:08<00:01, 232026.20 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  77%|███████▋  | 1482868/1914690 [00:09<00:01, 230156.80 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  79%|███████▊  | 1506604/1914690 [00:09<00:01, 230642.44 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  80%|███████▉  | 1530604/1914690 [00:09<00:01, 216588.18 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  81%|████████  | 1553604/1914690 [00:09<00:01, 219536.34 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  82%|████████▏ | 1576472/1914690 [00:09<00:01, 217903.05 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  84%|████████▎ | 1599208/1914690 [00:09<00:01, 214947.24 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  85%|████████▍ | 1621942/1914690 [00:09<00:01, 218223.68 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  86%|████████▌ | 1644678/1914690 [00:09<00:01, 201154.31 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  87%|████████▋ | 1665545/1914690 [00:09<00:01, 190509.86 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  88%|████████▊ | 1688545/1914690 [00:10<00:01, 194723.29 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  89%|████████▉ | 1709147/1914690 [00:10<00:01, 185643.21 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  90%|█████████ | 1728748/1914690 [00:10<00:01, 177528.63 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  91%|█████████▏| 1747483/1914690 [00:10<00:01, 163459.01 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  92%|█████████▏| 1764483/1914690 [00:10<00:00, 152659.90 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  93%|█████████▎| 1780217/1914690 [00:10<00:00, 147660.68 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  94%|█████████▍| 1795217/1914690 [00:10<00:00, 131619.87 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  94%|█████████▍| 1808951/1914690 [00:10<00:00, 128962.47 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  95%|█████████▌| 1822818/1914690 [00:11<00:00, 115326.47 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  96%|█████████▌| 1835685/1914690 [00:11<00:00, 116724.39 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  97%|█████████▋| 1848153/1914690 [00:11<00:00, 110014.26 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  97%|█████████▋| 1860020/1914690 [00:11<00:00, 89768.85 examples/s] 
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  98%|█████████▊| 1870020/1914690 [00:11<00:00, 84078.95 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  98%|█████████▊| 1878887/1914690 [00:11<00:00, 75298.08 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  99%|█████████▊| 1887754/1914690 [00:12<00:00, 69474.90 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  99%|█████████▉| 1895621/1914690 [00:12<00:00, 64349.46 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  99%|█████████▉| 1902488/1914690 [00:12<00:00, 60051.94 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40): 100%|█████████▉| 1909222/1914690 [00:12<00:00, 53523.79 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40): 100%|██████████| 1914690/1914690 [00:12<00:00, 149027.11 examples/s]
[36m(TaskRunner pid=3376910)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=3376910)[0m WARNING:2025-08-24 09:31:03,231:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   0%|          | 0/629183 [00:00<?, ? examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   0%|          | 1000/629183 [00:01<11:07, 940.53 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   1%|          | 4000/629183 [00:01<02:34, 4045.17 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   1%|▏         | 9000/629183 [00:01<01:06, 9306.65 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   3%|▎         | 17000/629183 [00:01<00:32, 18868.03 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   4%|▎         | 23000/629183 [00:01<00:24, 24403.20 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   5%|▌         | 34000/629183 [00:01<00:15, 38666.91 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   7%|▋         | 42000/629183 [00:01<00:13, 43390.14 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):   9%|▉         | 57000/629183 [00:02<00:08, 65054.13 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  10%|█         | 66000/629183 [00:02<00:08, 69211.49 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  13%|█▎        | 80000/629183 [00:02<00:06, 78508.37 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  15%|█▌        | 96000/629183 [00:02<00:05, 93879.31 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  18%|█▊        | 113000/629183 [00:02<00:05, 100870.67 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  21%|██        | 133000/629183 [00:02<00:04, 121669.97 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  23%|██▎       | 146000/629183 [00:02<00:04, 118133.72 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  27%|██▋       | 172730/629183 [00:02<00:02, 152971.85 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  30%|███       | 189730/629183 [00:03<00:03, 135367.87 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  34%|███▍      | 215190/629183 [00:03<00:02, 164445.24 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  37%|███▋      | 233920/629183 [00:03<00:02, 162079.53 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  40%|███▉      | 251650/629183 [00:03<00:02, 146726.04 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  44%|████▍     | 279110/629183 [00:03<00:02, 172264.19 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  47%|████▋     | 297840/629183 [00:03<00:02, 153995.59 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  52%|█████▏    | 325300/629183 [00:03<00:01, 170918.29 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  55%|█████▍    | 343030/629183 [00:03<00:01, 156671.21 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  58%|█████▊    | 366490/629183 [00:04<00:01, 170520.19 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  61%|██████    | 385220/629183 [00:04<00:01, 173888.08 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  64%|██████▍   | 403950/629183 [00:04<00:01, 176396.72 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  67%|██████▋   | 422410/629183 [00:04<00:01, 167834.51 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  70%|██████▉   | 440410/629183 [00:04<00:01, 170113.65 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  73%|███████▎  | 458140/629183 [00:04<00:01, 168346.75 examples/s]Filter (num_proc=40):  76%|███████▌  | 475600/629183 [00:04<00:00, 169380.99 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  78%|███████▊  | 493600/629183 [00:04<00:00, 163156.56 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  81%|████████  | 510790/629183 [00:04<00:00, 154240.90 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  84%|████████▎ | 526790/629183 [00:05<00:00, 143274.47 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  86%|████████▌ | 542248/629183 [00:05<00:00, 137562.23 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  88%|████████▊ | 556706/629183 [00:05<00:00, 127546.08 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  91%|█████████ | 569706/629183 [00:05<00:00, 117513.23 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  93%|█████████▎| 582435/629183 [00:05<00:00, 111330.90 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  94%|█████████▍| 593893/629183 [00:05<00:00, 103153.41 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  96%|█████████▌| 604351/629183 [00:05<00:00, 95855.23 examples/s] 
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  98%|█████████▊| 614809/629183 [00:06<00:00, 85752.80 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40):  99%|█████████▉| 624267/629183 [00:06<00:00, 66228.80 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=40): 100%|██████████| 629183/629183 [00:06<00:00, 93772.87 examples/s]
[36m(TaskRunner pid=3376910)[0m dataset len: 2273099
[36m(TaskRunner pid=3376910)[0m Using dataset class: RLHFDataset
[36m(TaskRunner pid=3376910)[0m num_proc must be <= 10. Reducing num_proc to 10 for dataset of size 10.
[36m(TaskRunner pid=3376910)[0m WARNING:2025-08-24 09:31:10,543:num_proc must be <= 10. Reducing num_proc to 10 for dataset of size 10.
[36m(TaskRunner pid=3376910)[0m Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=3376910)[0m WARNING:2025-08-24 09:31:10,545:Setting TOKENIZERS_PARALLELISM=false for forked processes.
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=10):   0%|          | 0/10 [00:00<?, ? examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=10):  10%|█         | 1/10 [00:00<00:04,  2.00 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=10):  30%|███       | 3/10 [00:00<00:01,  5.30 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=10):  50%|█████     | 5/10 [00:00<00:00,  7.25 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=10):  70%|███████   | 7/10 [00:01<00:00,  8.32 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=10):  90%|█████████ | 9/10 [00:01<00:00,  9.76 examples/s]
[36m(TaskRunner pid=3376910)[0m Filter (num_proc=10): 100%|██████████| 10/10 [00:01<00:00,  7.15 examples/s]
[36m(TaskRunner pid=3376910)[0m dataset len: 9
[36m(TaskRunner pid=3376910)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=3376910)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=3376910)[0m Size of train dataloader: 2219, Size of val dataloader: 1
[36m(TaskRunner pid=3376910)[0m Total training steps: 2219
[36m(TaskRunner pid=3376910)[0m colocated worker base class <class 'verl.single_controller.base.worker.Worker'>
[36m(TaskRunner pid=3376910)[0m WARNING:2025-08-24 09:31:12,802:Waiting for register center actor 7SlSXl_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(pid=3388849)[0m 2025-08-24 09:31:19.226240: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[36m(pid=3388849)[0m 2025-08-24 09:31:19.240157: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
[36m(pid=3388849)[0m 2025-08-24 09:31:19.257596: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
[36m(pid=3388849)[0m 2025-08-24 09:31:19.262405: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[36m(pid=3388849)[0m 2025-08-24 09:31:19.274442: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[36m(pid=3388849)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX512_FP16 AVX_VNNI AMX_TILE AMX_INT8 AMX_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[36m(pid=3388849)[0m 2025-08-24 09:31:20.210296: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[36m(pid=3389187)[0m 2025-08-24 09:31:30.783776: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[36m(pid=3389187)[0m 2025-08-24 09:31:30.797395: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
[36m(pid=3389187)[0m 2025-08-24 09:31:30.813678: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
[36m(pid=3389187)[0m 2025-08-24 09:31:30.818426: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[36m(pid=3389187)[0m 2025-08-24 09:31:30.830262: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[36m(pid=3389187)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX512_FP16 AVX_VNNI AMX_TILE AMX_INT8 AMX_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[36m(pid=3389190)[0m 2025-08-24 09:31:31.107212: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
[36m(pid=3389190)[0m 2025-08-24 09:31:31.120770: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
[36m(pid=3389190)[0m 2025-08-24 09:31:31.137051: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
[36m(pid=3389190)[0m 2025-08-24 09:31:31.141894: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
[36m(pid=3389190)[0m 2025-08-24 09:31:31.153733: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
[36m(pid=3389190)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX512_FP16 AVX_VNNI AMX_TILE AMX_INT8 AMX_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[36m(pid=3389187)[0m 2025-08-24 09:31:31.783651: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[36m(WorkerDict pid=3389187)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=3389187)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
[36m(WorkerDict pid=3389192)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.83s/it]
[36m(pid=3389189)[0m 2025-08-24 09:31:32.689675: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.[32m [repeated 5x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(pid=3389189)[0m 2025-08-24 09:31:32.703250: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered[32m [repeated 5x across cluster][0m
[36m(pid=3389189)[0m 2025-08-24 09:31:32.719641: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered[32m [repeated 5x across cluster][0m
[36m(pid=3389189)[0m 2025-08-24 09:31:32.724400: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered[32m [repeated 5x across cluster][0m
[36m(pid=3389189)[0m 2025-08-24 09:31:32.736219: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.[32m [repeated 5x across cluster][0m
[36m(pid=3389189)[0m To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX512_FP16 AVX_VNNI AMX_TILE AMX_INT8 AMX_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.[32m [repeated 5x across cluster][0m
[36m(pid=3389189)[0m 2025-08-24 09:31:33.726024: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=3388849)[0m Model config after override: Olmo2Config {
[36m(WorkerDict pid=3388849)[0m   "architectures": [
[36m(WorkerDict pid=3388849)[0m     "Olmo2ForCausalLM"
[36m(WorkerDict pid=3388849)[0m   ],
[36m(WorkerDict pid=3388849)[0m   "attention_bias": false,
[36m(WorkerDict pid=3388849)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=3388849)[0m   "bos_token_id": 100257,
[36m(WorkerDict pid=3388849)[0m   "eos_token_id": 100257,
[36m(WorkerDict pid=3388849)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=3388849)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=3388849)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=3388849)[0m   "intermediate_size": 8192,
[36m(WorkerDict pid=3388849)[0m   "max_position_embeddings": 4096,
[36m(WorkerDict pid=3388849)[0m   "model_type": "olmo2",
[36m(WorkerDict pid=3388849)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=3388849)[0m   "num_hidden_layers": 16,
[36m(WorkerDict pid=3388849)[0m   "num_key_value_heads": 16,
[36m(WorkerDict pid=3388849)[0m   "pad_token_id": 100277,
[36m(WorkerDict pid=3388849)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=3388849)[0m   "rope_scaling": null,
[36m(WorkerDict pid=3388849)[0m   "rope_theta": 500000,
[36m(WorkerDict pid=3388849)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=3388849)[0m   "torch_dtype": "float32",
[36m(WorkerDict pid=3388849)[0m   "transformers_version": "4.51.1",
[36m(WorkerDict pid=3388849)[0m   "use_cache": true,
[36m(WorkerDict pid=3388849)[0m   "vocab_size": 100352
[36m(WorkerDict pid=3388849)[0m }
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3389192)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.04it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.10s/it]
[36m(WorkerDict pid=3389192)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=3389192)[0m Skipping monkey patch for Olmo2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch
[36m(WorkerDict pid=3388849)[0m Olmo2ForCausalLM contains 1.48B parameters
[36m(WorkerDict pid=3388849)[0m wrap_policy: functools.partial(<function _or_policy at 0x7c23fb3cae60>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7c23fb3cad40>, transformer_layer_cls={<class 'transformers.models.olmo2.modeling_olmo2.Olmo2DecoderLayer'>})])
[36m(WorkerDict pid=3388849)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3390602 [0] /nccl-shim-net/src/guest_config_checker.cc:101 NCCL WARN NCCL/NET (shim) mismatch recommended: NCCL_FASTRAK_LLCM_DEVICE_DIRECTORY=/dev/aperture_devices (expected unset)
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3390602 [0] /nccl-shim-net/src/guest_config_checker.cc:101 NCCL WARN NCCL/NET (shim) mismatch recommended: NCCL_LIB_DIR=/usr/local/nvidia/lib64 (expected unset)
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3390602 [0] /nccl-shim-net/src/guest_config_checker.cc:101 NCCL WARN NCCL/NET (shim) mismatch recommended: NCCL_DYNAMIC_CHUNK_SIZE=524288 (expected unset)
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3390602 [0] /nccl-shim-net/src/guest_config_checker.cc:101 NCCL WARN NCCL/NET (shim) mismatch recommended: NCCL_TESTS_VERSION=2.13.6 (expected unset)
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3390602 [0] /nccl-shim-net/src/guest_config_checker.cc:101 NCCL WARN NCCL/NET (shim) mismatch recommended: cpu affinity settings not subset, curr=0xffff,ffffffff,ffffffff,ffffffff,ffffffff,ffffffff,ffffffff (expected 0xffffffff,00000000)
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3390602 [0] /nccl-tuner-config-based/src/config_based_tuner.cc:155 NCCL WARN Cannot find communicatorTunerConfig for communicator(num_node:1, num_rank:8) with config:communicator_configs {
[36m(WorkerDict pid=3388849)[0m   node_range {
[36m(WorkerDict pid=3388849)[0m     min: 2
[36m(WorkerDict pid=3388849)[0m     max: 3
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   rank_per_node_range {
[36m(WorkerDict pid=3388849)[0m     min: 1
[36m(WorkerDict pid=3388849)[0m     max: 2
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   coll_configs {
[36m(WorkerDict pid=3388849)[0m     coll_type: COLL_ALL_REDUCE
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 0
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 2
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: ALGO_TREE
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m     }
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   coll_configs {
[36m(WorkerDict pid=3388849)[0m     coll_type: COLL_DEFAULT
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 0
[36m(WorkerDict pid=3388849)[0m         max: 65536
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 2
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: ALGO_RING
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m     }
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 65536
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 4
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: AL
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3390602 [0] /nccl-tuner-config-based/src/config_based_tuner.cc:271 NCCL WARN No communicator config selected from config:communicator_configs {
[36m(WorkerDict pid=3388849)[0m   node_range {
[36m(WorkerDict pid=3388849)[0m     min: 2
[36m(WorkerDict pid=3388849)[0m     max: 3
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   rank_per_node_range {
[36m(WorkerDict pid=3388849)[0m     min: 1
[36m(WorkerDict pid=3388849)[0m     max: 2
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   coll_configs {
[36m(WorkerDict pid=3388849)[0m     coll_type: COLL_ALL_REDUCE
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 0
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 2
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: ALGO_TREE
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m     }
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   coll_configs {
[36m(WorkerDict pid=3388849)[0m     coll_type: COLL_DEFAULT
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 0
[36m(WorkerDict pid=3388849)[0m         max: 65536
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 2
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: ALGO_RING
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m     }
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 65536
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 4
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: ALGO_RING
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m     }
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m }
[36m(WorkerDict pid=3388849)[0m communicator_conf
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3390602 [0] /nccl-tuner-config-based/src/tuner_tcpx.cc:70 NCCL WARN No communicator found for nRanks:8, nNodes:1 from config_path:/usr/local/nvidia/lib64/a3plus_tuner_config.textproto
[36m(WorkerDict pid=3388849)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3388849)[0m Skipping monkey patch for Olmo2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389191)[0m bolt-8xfg93i4zr-6csgcu35ry:3389191:3390612 [0] /nccl-shim-net/src/guest_config_checker.cc:101 NCCL WARN NCCL/NET (shim) mismatch recommended: NCCL_FASTRAK_LLCM_DEVICE_DIRECTORY=/dev/aperture_devices (expected unset)[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389191)[0m bolt-8xfg93i4zr-6csgcu35ry:3389191:3390612 [0] /nccl-shim-net/src/guest_config_checker.cc:101 NCCL WARN NCCL/NET (shim) mismatch recommended: NCCL_TESTS_VERSION=2.13.6 (expected unset)[32m [repeated 21x across cluster][0m
[36m(WorkerDict pid=3389191)[0m bolt-8xfg93i4zr-6csgcu35ry:3389191:3390612 [0] /nccl-shim-net/src/guest_config_checker.cc:101 NCCL WARN NCCL/NET (shim) mismatch recommended: cpu affinity settings not subset, curr=0xffff,ffffffff,ffffffff,ffffffff,ffffffff,ffffffff,ffffffff (expected 0xffffffff,00000000)[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389189)[0m   }
[36m(WorkerDict pid=3389189)[0m   }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m     }
[36m(WorkerDict pid=3389189)[0m   }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m     }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389189)[0m   }
[36m(WorkerDict pid=3389189)[0m   }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m     }
[36m(WorkerDict pid=3389189)[0m   }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m     }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m       }
[36m(WorkerDict pid=3389189)[0m     }
[36m(WorkerDict pid=3389189)[0m   }
[36m(WorkerDict pid=3389189)[0m }
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(WorkerDict pid=3388849)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=3388849)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=3388849)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Olmo2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=3388849)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3388849)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=3388849)[0m Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.88s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3388849)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.03it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.11s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3388849)[0m Model config after override: Olmo2Config {
[36m(WorkerDict pid=3388849)[0m   "architectures": [
[36m(WorkerDict pid=3388849)[0m     "Olmo2ForCausalLM"
[36m(WorkerDict pid=3388849)[0m   ],
[36m(WorkerDict pid=3388849)[0m   "attention_bias": false,
[36m(WorkerDict pid=3388849)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=3388849)[0m   "bos_token_id": 100257,
[36m(WorkerDict pid=3388849)[0m   "eos_token_id": 100257,
[36m(WorkerDict pid=3388849)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=3388849)[0m   "hidden_size": 2048,
[36m(WorkerDict pid=3388849)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=3388849)[0m   "intermediate_size": 8192,
[36m(WorkerDict pid=3388849)[0m   "max_position_embeddings": 4096,
[36m(WorkerDict pid=3388849)[0m   "model_type": "olmo2",
[36m(WorkerDict pid=3388849)[0m   "num_attention_heads": 16,
[36m(WorkerDict pid=3388849)[0m   "num_hidden_layers": 16,
[36m(WorkerDict pid=3388849)[0m   "num_key_value_heads": 16,
[36m(WorkerDict pid=3388849)[0m   "pad_token_id": 100277,
[36m(WorkerDict pid=3388849)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=3388849)[0m   "rope_scaling": null,
[36m(WorkerDict pid=3388849)[0m   "rope_theta": 500000,
[36m(WorkerDict pid=3388849)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=3388849)[0m   "torch_dtype": "float32",
[36m(WorkerDict pid=3388849)[0m   "transformers_version": "4.51.1",
[36m(WorkerDict pid=3388849)[0m   "use_cache": true,
[36m(WorkerDict pid=3388849)[0m   "vocab_size": 100352
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 44.09it/s]
[36m(WorkerDict pid=3388849)[0m Olmo2ForCausalLM contains 1.48B parameters
[36m(WorkerDict pid=3388849)[0m wrap_policy: functools.partial(<function _or_policy at 0x7c23fb3cae60>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7c23fb3cad40>, transformer_layer_cls={<class 'transformers.models.olmo2.modeling_olmo2.Olmo2DecoderLayer'>})])
[36m(WorkerDict pid=3389193)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 50.67it/s]
[36m(WorkerDict pid=3388849)[0m Total steps: 2219, num_warmup_steps: 0
[36m(WorkerDict pid=3388849)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=3388849)[0m Actor use_fused_kernels=False
[36m(WorkerDict pid=3389190)[0m   0%|          | 0/23 [00:00<?, ?it/s]Capturing batches (avail_mem=13.93 GB):   0%|          | 0/23 [00:00<?, ?it/s]
[36m(WorkerDict pid=3389190)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Olmo2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389190)[0m Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s][32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=3389190)[0m Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00, 49.56it/s][32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=3389190)[0m Capturing batches (avail_mem=13.93 GB):   4%|▍         | 1/23 [00:00<00:18,  1.21it/s]Capturing batches (avail_mem=13.68 GB):   4%|▍         | 1/23 [00:00<00:18,  1.21it/s]
[36m(WorkerDict pid=3389189)[0m   0%|          | 0/23 [00:00<?, ?it/s]Capturing batches (avail_mem=13.93 GB):   0%|          | 0/23 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3388849)[0m Capturing batches (avail_mem=12.47 GB):  52%|█████▏    | 12/23 [00:05<00:04,  2.26it/s]Capturing batches (avail_mem=12.43 GB):  52%|█████▏    | 12/23 [00:05<00:04,  2.26it/s][32m [repeated 61x across cluster][0m
[36m(WorkerDict pid=3388849)[0m Capturing batches (avail_mem=12.20 GB):  91%|█████████▏| 21/23 [00:09<00:00,  2.28it/s]Capturing batches (avail_mem=12.20 GB):  91%|█████████▏| 21/23 [00:09<00:00,  2.28it/s]
[36m(WorkerDict pid=3388849)[0m Capturing batches (avail_mem=12.20 GB):  96%|█████████▌| 22/23 [00:10<00:00,  2.29it/s]Capturing batches (avail_mem=12.19 GB):  96%|█████████▌| 22/23 [00:10<00:00,  2.29it/s]
[36m(WorkerDict pid=3388849)[0m Capturing batches (avail_mem=12.19 GB): 100%|██████████| 23/23 [00:10<00:00,  2.29it/s]Capturing batches (avail_mem=12.19 GB): 100%|██████████| 23/23 [00:10<00:00,  2.19it/s]
[36m(WorkerDict pid=3389187)[0m Capturing batches (avail_mem=12.45 GB):  83%|████████▎ | 19/23 [00:09<00:01,  2.13it/s]Capturing batches (avail_mem=12.44 GB):  83%|████████▎ | 19/23 [00:09<00:01,  2.13it/s][32m [repeated 75x across cluster][0m
[36m(WorkerDict pid=3388849)[0m /usr/local/lib/python3.10/dist-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=3388849)[0m   warnings.warn(
[36m(WorkerDict pid=3388849)[0m Only support config type of {'qwen2', 'llama', 'qwen2_vl', 'qwen3', 'qwen2_5_vl', 'qwen3_moe', 'deepseek_v3', 'minicpmv', 'minicpmo'}, but got olmo2. MFU will always be zero.
[36m(WorkerDict pid=3389193)[0m bolt-8xfg93i4zr-6csgcu35ry:3389193:3390608 [0] /nccl-tuner-config-based/src/config_based_tuner.cc:155 NCCL WARN Cannot find communicatorTunerConfig for communicator(num_node:1, num_rank:8) with config:communicator_configs {[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389193)[0m   node_range {[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         min: 65536[32m [repeated 70x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         max: 65536[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m   rank_per_node_range {[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=3389193)[0m   coll_configs {[32m [repeated 28x across cluster][0m
[36m(WorkerDict pid=3389193)[0m     coll_type: COLL_ALL_REDUCE[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=3389193)[0m     msg_size_tuning_rules {[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m       per_rank_message_size {[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m       coll_tuning_spec {[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         num_channel: 4[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         protocol: PROTO_SIMPLE[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         algorithm: ALGO_TREE[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=3389193)[0m     coll_type: COLL_DEFAULT[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         algorithm: ALGO_RING[32m [repeated 21x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         algorithm: AL[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389193)[0m bolt-8xfg93i4zr-6csgcu35ry:3389193:3390608 [0] /nccl-tuner-config-based/src/config_based_tuner.cc:271 NCCL WARN No communicator config selected from config:communicator_configs {[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389193)[0m communicator_conf[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389193)[0m bolt-8xfg93i4zr-6csgcu35ry:3389193:3390608 [0] /nccl-tuner-config-based/src/tuner_tcpx.cc:70 NCCL WARN No communicator found for nRanks:8, nNodes:1 from config_path:/usr/local/nvidia/lib64/a3plus_tuner_config.textproto[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389193)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=3389193)[0m Skipping monkey patch for Olmo2ForCausalLM as use_fused_kernels is False or fused_kernels_backend is torch[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=3388849)[0m }[32m [repeated 145x across cluster][0m
[36m(WorkerDict pid=3389190)[0m Only support config type of {'qwen2', 'qwen3_moe', 'minicpmo', 'qwen2_5_vl', 'llama', 'qwen3', 'qwen2_vl', 'deepseek_v3', 'minicpmv'}, but got olmo2. MFU will always be zero.
[36m(WorkerDict pid=3389187)[0m Only support config type of {'qwen3', 'qwen2', 'minicpmv', 'qwen2_5_vl', 'minicpmo', 'qwen2_vl', 'llama', 'deepseek_v3', 'qwen3_moe'}, but got olmo2. MFU will always be zero.
[36m(WorkerDict pid=3389192)[0m Only support config type of {'minicpmo', 'qwen2_5_vl', 'qwen2', 'llama', 'qwen3_moe', 'qwen2_vl', 'minicpmv', 'deepseek_v3', 'qwen3'}, but got olmo2. MFU will always be zero.
[36m(WorkerDict pid=3389193)[0m Capturing batches (avail_mem=12.51 GB):  96%|█████████▌| 22/23 [00:13<00:00,  1.74it/s]Capturing batches (avail_mem=12.50 GB):  96%|█████████▌| 22/23 [00:13<00:00,  1.74it/s][32m [repeated 18x across cluster][0m
[36m(WorkerDict pid=3389189)[0m Only support config type of {'minicpmv', 'minicpmo', 'llama', 'qwen2_vl', 'qwen2', 'qwen2_5_vl', 'qwen3_moe', 'deepseek_v3', 'qwen3'}, but got olmo2. MFU will always be zero.
[36m(WorkerDict pid=3389188)[0m Only support config type of {'qwen2_5_vl', 'qwen3', 'qwen2', 'minicpmo', 'qwen3_moe', 'minicpmv', 'qwen2_vl', 'deepseek_v3', 'llama'}, but got olmo2. MFU will always be zero.
[36m(TaskRunner pid=3376910)[0m wandb: Currently logged in as: shenaozhang (shenaoz) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(WorkerDict pid=3389193)[0m Capturing batches (avail_mem=12.52 GB):  87%|████████▋ | 20/23 [00:12<00:01,  1.73it/s]Capturing batches (avail_mem=12.51 GB):  87%|████████▋ | 20/23 [00:12<00:01,  1.73it/s][32m [repeated 23x across cluster][0m
[36m(WorkerDict pid=3389193)[0m /usr/local/lib/python3.10/dist-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389193)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3376910)[0m wandb: Tracking run with wandb version 0.21.1
[36m(TaskRunner pid=3376910)[0m wandb: Run data is saved locally in /mnt/task_runtime/verl/wandb/run-20250824_093250-3zi44yz0
[36m(TaskRunner pid=3376910)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(TaskRunner pid=3376910)[0m wandb: Syncing run 80-200-olmo-nowarmup-nopenalty-log-nolenpenalty
[36m(TaskRunner pid=3376910)[0m wandb: ⭐️ View project at https://wandb.ai/shenaoz/em-correct
[36m(TaskRunner pid=3376910)[0m wandb: 🚀 View run at https://wandb.ai/shenaoz/em-correct/runs/3zi44yz0
[36m(TaskRunner pid=3376910)[0m Training Progress:   0%|          | 0/2219 [00:00<?, ?it/s]
[36m(TaskRunner pid=3376910)[0m Checkpoint tracker file does not exist: /mnt/task_wrapper/user_output/artifacts/checkpoints/em-correct/80-200-olmo-nowarmup-nopenalty-log-nolenpenalty/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=3376910)[0m Training from scratch
[36m(TaskRunner pid=3376910)[0m global_steps 1
[36m(WorkerDict pid=3389191)[0m Only support config type of {'minicpmo', 'llama', 'qwen2', 'deepseek_v3', 'minicpmv', 'qwen3_moe', 'qwen2_5_vl', 'qwen2_vl', 'qwen3'}, but got olmo2. MFU will always be zero.
[36m(WorkerDict pid=3388849)[0m /mnt/task_runtime/verl/verl/workers/rollout/sglang_rollout/utils.py:49: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
[36m(WorkerDict pid=3388849)[0m   tensor_data = torch.ByteTensor(np.frombuffer(serialized_data, dtype=np.uint8)).to(device)
[36m(WorkerDict pid=3389193)[0m Capturing batches (avail_mem=12.50 GB): 100%|██████████| 23/23 [00:13<00:00,  1.73it/s]Capturing batches (avail_mem=12.50 GB): 100%|██████████| 23/23 [00:13<00:00,  1.65it/s][32m [repeated 3x across cluster][0m
[36m(WorkerDict pid=3389189)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=3389193)[0m Only support config type of {'qwen2_vl', 'minicpmo', 'qwen3_moe', 'deepseek_v3', 'qwen3', 'qwen2', 'minicpmv', 'qwen2_5_vl', 'llama'}, but got olmo2. MFU will always be zero.
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3393593 [0] /nccl-tuner-config-based/src/config_based_tuner.cc:155 NCCL WARN Cannot find communicatorTunerConfig for communicator(num_node:1, num_rank:1) with config:communicator_configs {
[36m(WorkerDict pid=3388849)[0m   node_range {
[36m(WorkerDict pid=3388849)[0m     min: 2
[36m(WorkerDict pid=3388849)[0m     max: 3
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   rank_per_node_range {
[36m(WorkerDict pid=3388849)[0m     min: 1
[36m(WorkerDict pid=3388849)[0m     max: 2
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   coll_configs {
[36m(WorkerDict pid=3388849)[0m     coll_type: COLL_ALL_REDUCE
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 0
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 2
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: ALGO_TREE
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m     }
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   coll_configs {
[36m(WorkerDict pid=3388849)[0m     coll_type: COLL_DEFAULT
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 0
[36m(WorkerDict pid=3388849)[0m         max: 65536
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 2
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: ALGO_RING
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m     }
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 65536
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 4
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: AL
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3393593 [0] /nccl-tuner-config-based/src/config_based_tuner.cc:271 NCCL WARN No communicator config selected from config:communicator_configs {
[36m(WorkerDict pid=3388849)[0m   node_range {
[36m(WorkerDict pid=3388849)[0m     min: 2
[36m(WorkerDict pid=3388849)[0m     max: 3
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   rank_per_node_range {
[36m(WorkerDict pid=3388849)[0m     min: 1
[36m(WorkerDict pid=3388849)[0m     max: 2
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   coll_configs {
[36m(WorkerDict pid=3388849)[0m     coll_type: COLL_ALL_REDUCE
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 0
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 2
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: ALGO_TREE
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m     }
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m   coll_configs {
[36m(WorkerDict pid=3388849)[0m     coll_type: COLL_DEFAULT
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 0
[36m(WorkerDict pid=3388849)[0m         max: 65536
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 2
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: ALGO_RING
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m     }
[36m(WorkerDict pid=3388849)[0m     msg_size_tuning_rules {
[36m(WorkerDict pid=3388849)[0m       per_rank_message_size {
[36m(WorkerDict pid=3388849)[0m         min: 65536
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m       coll_tuning_spec {
[36m(WorkerDict pid=3388849)[0m         num_channel: 4
[36m(WorkerDict pid=3388849)[0m         protocol: PROTO_SIMPLE
[36m(WorkerDict pid=3388849)[0m         algorithm: ALGO_RING
[36m(WorkerDict pid=3388849)[0m       }
[36m(WorkerDict pid=3388849)[0m     }
[36m(WorkerDict pid=3388849)[0m   }
[36m(WorkerDict pid=3388849)[0m }
[36m(WorkerDict pid=3388849)[0m communicator_conf
[36m(WorkerDict pid=3388849)[0m 
[36m(WorkerDict pid=3388849)[0m bolt-8xfg93i4zr-6csgcu35ry:3388849:3393593 [0] /nccl-tuner-config-based/src/tuner_tcpx.cc:70 NCCL WARN No communicator found for nRanks:1, nNodes:1 from config_path:/usr/local/nvidia/lib64/a3plus_tuner_config.textproto
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389189)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389190)[0m 
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389187)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389188)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389192)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3389191)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(WorkerDict pid=3389193)[0m 
[36m(TaskRunner pid=3376910)[0m first_prompt: class Solution(object): end1prompt
[36m(TaskRunner pid=3376910)[0m first_res:  pass
[36m(TaskRunner pid=3376910)[0m (applyoa) Testing Twelve is open to the public, JOIN US endfirst
[36m(TaskRunner pid=3376910)[0m second_prompt:     def shortestPalindrome(self, s): end2prompt
[36m(TaskRunner pid=3376910)[0m second_res:      """Return the shortest palindromic string given a copy of "s endsecond
[36m(TaskRunner pid=3376910)[0m third_prompt:         """
[36m(TaskRunner pid=3376910)[0m         :type s: str
[36m(TaskRunner pid=3376910)[0m         :rtype: str
[36m(TaskRunner pid=3376910)[0m         """
[36m(TaskRunner pid=3376910)[0m         new = s + "#" + s[::-1] end3prompt
[36m(TaskRunner pid=3376910)[0m third_res:       """and Shift to the right one's place"""         result = re.compile endthird
[36m(TaskRunner pid=3376910)[0m fourth_prompt:         next = [-1] * len(new) end4prompt
[36m(TaskRunner pid=3376910)[0m fourth_res:   if new[-1] == s[-1]:     result.sub(       endfourth
[36m(TaskRunner pid=3376910)[0m fifth_prompt:         i, j = -1, 0 end5prompt
[36m(TaskRunner pid=3376910)[0m fifth_res: , for n, j in enumerate(re.finditer(,s))        if endfifth
[36m(TaskRunner pid=3376910)[0m six_prompt:         #generate the KMP table
[36m(TaskRunner pid=3376910)[0m         while j < len(new) - 1:   endsix
[36m(TaskRunner pid=3376910)[0m six_res:  #if first pass retains an index
[36m(TaskRunner pid=3376910)[0m         key.left = kn [k + endsix
[36m(TaskRunner pid=3376910)[0m seven_prompt:             #needle[k] stands for prefix, neelde[j] stands for postfix
[36m(TaskRunner pid=3376910)[0m             if i == -1 or new[i] == new[j]:    end7prompt
[36m(TaskRunner pid=3376910)[0m seven_res:  for m in new:     #a, m an index in the current row endseven
[36m(WorkerDict pid=3389193)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=3389193)[0m bolt-8xfg93i4zr-6csgcu35ry:3389193:3393599 [0] /nccl-tuner-config-based/src/config_based_tuner.cc:155 NCCL WARN Cannot find communicatorTunerConfig for communicator(num_node:1, num_rank:1) with config:communicator_configs {[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389193)[0m   node_range {[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         min: 65536[32m [repeated 70x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         max: 65536[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m }[32m [repeated 168x across cluster][0m
[36m(WorkerDict pid=3389193)[0m   rank_per_node_range {[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=3389193)[0m   coll_configs {[32m [repeated 28x across cluster][0m
[36m(WorkerDict pid=3389193)[0m     coll_type: COLL_ALL_REDUCE[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=3389193)[0m     msg_size_tuning_rules {[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m       per_rank_message_size {[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m       coll_tuning_spec {[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         num_channel: 4[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         protocol: PROTO_SIMPLE[32m [repeated 42x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         algorithm: ALGO_TREE[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=3389193)[0m     coll_type: COLL_DEFAULT[32m [repeated 14x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         algorithm: ALGO_RING[32m [repeated 21x across cluster][0m
[36m(WorkerDict pid=3389193)[0m         algorithm: AL[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389193)[0m bolt-8xfg93i4zr-6csgcu35ry:3389193:3393599 [0] /nccl-tuner-config-based/src/config_based_tuner.cc:271 NCCL WARN No communicator config selected from config:communicator_configs {[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389193)[0m communicator_conf[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389193)[0m bolt-8xfg93i4zr-6csgcu35ry:3389193:3393599 [0] /nccl-tuner-config-based/src/tuner_tcpx.cc:70 NCCL WARN No communicator found for nRanks:1, nNodes:1 from config_path:/usr/local/nvidia/lib64/a3plus_tuner_config.textproto[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3376910)[0m Training Progress:   0%|          | 1/2219 [01:03<39:14:01, 63.68s/it]
[36m(WorkerDict pid=3389190)[0m /mnt/task_runtime/verl/verl/workers/rollout/sglang_rollout/utils.py:49: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3389190)[0m   tensor_data = torch.ByteTensor(np.frombuffer(serialized_data, dtype=np.uint8)).to(device)[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3376910)[0m step:1 - global_seqlen/min:206223 - global_seqlen/max:239739 - global_seqlen/minmax_diff:33516 - global_seqlen/balanced_min:225784 - global_seqlen/balanced_max:225785 - global_seqlen/mean:225784.375 - actor/entropy:3.0066535472869873 - actor/pg_loss:0.13378958274843172 - actor/pg_clipfrac:0.015446402924135327 - actor/ppo_kl:-0.01771132096200745 - actor/pg_clipfrac_lower:0.0008712484399438835 - actor/grad_norm:0.5929492563009262 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:14.569864273071289 - perf/max_memory_reserved_gb:29.62890625 - perf/cpu_memory_used_gb:73.05570983886719 - actor/lr:2e-06 - training/global_step:1 - training/epoch:0 - critic/rewards/mean:-1.7916911840438843 - critic/advantages/mean:-0.14626586437225342 - critic/advantages/max:1.788852334022522 - critic/advantages/min:-1.7888530492782593 - critic/format_reward/mean:0.2812008559703827 - critic/skip_freq:0.1670295149087906 - response_length/mean:12.92456340789795 - response_length/max:17.0 - response_length/min:1.0 - response_length/clip_ratio:0.0 - prompt_length/mean:28.486328125 - prompt_length/max:128.0 - prompt_length/min:2.0 - prompt_length/clip_ratio:0.0009765625 - timing_s/start_profile:1.6048026736825705e-05 - timing_s/generate_sequences:39.034324645996094 - timing_s/reshard:0.638932466506958 - timing_s/gen:40.62741354003083 - timing_s/reward:0.9841217699577101 - timing_s/old_log_prob:5.245448737987317 - timing_s/ref:3.796802667027805 - timing_s/adv:0.520180200051982 - timing_s/update_actor:11.057576222985517 - timing_s/step:62.407805998052936 - timing_s/stop_profile:3.3919932320713997e-06 - timing_per_token_ms/gen:0.6139504553853298 - timing_per_token_ms/adv:0.0024534051572879284 - timing_per_token_ms/ref:0.01790743908276346 - timing_per_token_ms/update_actor:0.05215253200692 - perf/total_num_tokens:1806275 - perf/time_per_step:62.407805998052936 - perf/throughput:3617.886759342962
[36m(TaskRunner pid=3376910)[0m global_steps 2
[36m(TaskRunner pid=3376910)[0m first_prompt: # from random import choice
[36m(TaskRunner pid=3376910)[0m # class RandomizedSet():
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m #     def __init__(self):
[36m(TaskRunner pid=3376910)[0m #         self.set = dict()
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m #     def insert(self, val: int) -> bool:
[36m(TaskRunner pid=3376910)[0m #         if val not in self.set:
[36m(TaskRunner pid=3376910)[0m #             self.set[val] = ''
[36m(TaskRunner pid=3376910)[0m #             return True
[36m(TaskRunner pid=3376910)[0m #         return False
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m #     def remove(self, val: int) -> bool:
[36m(TaskRunner pid=3376910)[0m #         if val in self.set:
[36m(TaskRunner pid=3376910)[0m #             del self.set[val]
[36m(TaskRunner pid=3376910)[0m #             return True
[36m(TaskRunner pid=3376910)[0m #         return False
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m #     def getRandom(self) -> int:
[36m(TaskRunner pid=3376910)[0m #         return choice(list(self.set))
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m from random import choice end1prompt
[36m(TaskRunner pid=3376910)[0m first_res: 
[36m(TaskRunner pid=3376910)[0m  endfirst
[36m(TaskRunner pid=3376910)[0m second_prompt: class RandomizedSet(): end2prompt
[36m(TaskRunner pid=3376910)[0m second_res: 
[36m(TaskRunner pid=3376910)[0m  endsecond
[36m(TaskRunner pid=3376910)[0m third_prompt: 
[36m(TaskRunner pid=3376910)[0m     def __init__(self): end3prompt
[36m(TaskRunner pid=3376910)[0m third_res: 
[36m(TaskRunner pid=3376910)[0m  endthird
[36m(TaskRunner pid=3376910)[0m fourth_prompt:         self.map = dict() end4prompt
[36m(TaskRunner pid=3376910)[0m fourth_res: 
[36m(TaskRunner pid=3376910)[0m  endfourth
[36m(TaskRunner pid=3376910)[0m fifth_prompt:         self.list = list() end5prompt
[36m(TaskRunner pid=3376910)[0m fifth_res:  # Now the object contains a list known to be sorted by key
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m     def endfifth
[36m(TaskRunner pid=3376910)[0m six_prompt: 
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m     def insert(self, val: int) -> bool: endsix
[36m(TaskRunner pid=3376910)[0m six_res:  # Adds a new key / element
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m     def remove(self, val: int endsix
[36m(TaskRunner pid=3376910)[0m seven_prompt:         if val not in self.map: end7prompt
[36m(TaskRunner pid=3376910)[0m seven_res:  # Removes any keys / elements
[36m(TaskRunner pid=3376910)[0m         ) -> bool:
[36m(TaskRunner pid=3376910)[0m     def getRandom(self endseven
[36m(TaskRunner pid=3376910)[0m Training Progress:   0%|          | 2/2219 [01:58<35:59:58, 58.46s/it]
[36m(TaskRunner pid=3376910)[0m step:2 - global_seqlen/min:193079 - global_seqlen/max:216277 - global_seqlen/minmax_diff:23198 - global_seqlen/balanced_min:206143 - global_seqlen/balanced_max:206144 - global_seqlen/mean:206143.125 - actor/entropy:2.8261656761169434 - actor/pg_loss:0.23072033934295177 - actor/pg_clipfrac:0.014994367072358728 - actor/ppo_kl:-0.009969492079835617 - actor/pg_clipfrac_lower:0.0010280976246576756 - actor/grad_norm:0.8001988679170609 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:14.811521053314209 - perf/max_memory_reserved_gb:30.01953125 - perf/cpu_memory_used_gb:73.52323913574219 - actor/lr:2e-06 - training/global_step:2 - training/epoch:0 - critic/rewards/mean:-1.5909368991851807 - critic/advantages/mean:-0.21876627206802368 - critic/advantages/max:1.7888524532318115 - critic/advantages/min:-1.7888528108596802 - critic/format_reward/mean:0.42322486639022827 - critic/skip_freq:0.29217031598091125 - response_length/mean:10.667059898376465 - response_length/max:16.299999237060547 - response_length/min:1.0 - response_length/clip_ratio:0.0 - prompt_length/mean:27.76171875 - prompt_length/max:128.0 - prompt_length/min:2.0 - prompt_length/clip_ratio:0.001953125 - timing_s/start_profile:4.655041266232729e-06 - timing_s/generate_sequences:34.32345199584961 - timing_s/reshard:0.9478746652603149 - timing_s/gen:36.24182141397614 - timing_s/reward:0.9558156830025837 - timing_s/old_log_prob:2.665680162026547 - timing_s/ref:2.6151731520076282 - timing_s/adv:0.4766530789784156 - timing_s/update_actor:11.433524466003291 - timing_s/step:54.55593267199583 - timing_s/stop_profile:2.695014700293541e-06 - timing_per_token_ms/gen:0.6635830946656758 - timing_per_token_ms/adv:0.0024225673388617273 - timing_per_token_ms/ref:0.013291497197710634 - timing_per_token_ms/update_actor:0.05811036194034598 - perf/total_num_tokens:1649145 - perf/time_per_step:54.55593267199583 - perf/throughput:3778.5647665375823
[36m(TaskRunner pid=3376910)[0m global_steps 3
[36m(TaskRunner pid=3376910)[0m first_prompt: #https://programmers.co.kr/learn/courses/30/lessons/49993#fnref1
[36m(TaskRunner pid=3376910)[0m 
[36m(TaskRunner pid=3376910)[0m def solution(skill, skill_trees): end1prompt
[36m(TaskRunner pid=3376910)[0m first_res: 
[36m(TaskRunner pid=3376910)[0m #programmers
[36m(TaskRunner pid=3376910)[0m  endfirst
[36m(TaskRunner pid=3376910)[0m second_prompt:     answer = [] #s의 모음들 end2prompt
[36m(TaskRunner pid=3376910)[0m second_res: 의 님의 부분 소 components이 psychological explanation 분별 endsecond
[36m(TaskRunner pid=3376910)[0m third_prompt:     s = [] #skilltree내에 있는 skill의 알파벳만 넣는 리스트(answer에 넣기 위해 잠시 모아둠) end3prompt
[36m(TaskRunner pid=3376910)[0m third_res: 
[36m(TaskRunner pid=3376910)[0m  endthird
[36m(TaskRunner pid=3376910)[0m fourth_prompt:     result = 0 # (skill 순서대로 넣은 skilltree) 와 (skill에 포함되지 않은 알파벳으로만 이루어진 skilltree) end4prompt
[36m(TaskRunner pid=3376910)[0m fourth_res:   # (skill tree와 spell tree가 뛰어나서) endfourth
[36m(TaskRunner pid=3376910)[0m fifth_prompt:     bask = 0 end5prompt
[36m(TaskRunner pid=3376910)[0m fifth_res: 
[36m(TaskRunner pid=3376910)[0m     #심심하게 힘들Hotel Rooms � endfifth
[36m(TaskRunner pid=3376910)[0m six_prompt:     # skill_trees에 포함된 요소중 skill에 포함되지 않은 알파벳으로만 이루어진 경우,
[36m(TaskRunner pid=3376910)[0m     # 어떤 스킬을 넣어도 상관없으므로, bask 랑 skill에 포함되지 않은 알파벳 숫자랑 같으면 result += 1을 추가한다.
[36m(TaskRunner pid=3376910)[0m     # (이것떔에 많이 헤맴.. 역시 testcase만 믿지 말자..)
[36m(TaskRunner pid=3376910)[0m     for i, e in enumerate(skill_trees): endsix
[36m(TaskRunner pid=3376910)[0m six_res: 
[36m(TaskRunner pid=3376910)[0m  endsix
[36m(TaskRunner pid=3376910)[0m seven_prompt:         for j in e: end7prompt
[36m(TaskRunner pid=3376910)[0m seven_res:  #kj가를 index로-o-assasinate를 하게 됨
[36m(TaskRunner pid=3376910)[0m  endseven
[36m(TaskRunner pid=3376910)[0m Training Progress:   0%|          | 3/2219 [02:52<34:45:19, 56.46s/it]
[36m(TaskRunner pid=3376910)[0m step:3 - global_seqlen/min:167952 - global_seqlen/max:196342 - global_seqlen/minmax_diff:28390 - global_seqlen/balanced_min:183391 - global_seqlen/balanced_max:183392 - global_seqlen/mean:183391.875 - actor/entropy:2.4921181201934814 - actor/pg_loss:0.33142722249031065 - actor/pg_clipfrac:0.028673339867964387 - actor/ppo_kl:-0.0071624780190177265 - actor/pg_clipfrac_lower:0.0007951622435939498 - actor/grad_norm:1.0391381606459618 - perf/mfu/actor:0.0 - perf/max_memory_allocated_gb:14.811521053314209 - perf/max_memory_reserved_gb:30.01953125 - perf/cpu_memory_used_gb:73.75187683105469 - actor/lr:2e-06 - training/global_step:3 - training/epoch:0 - critic/rewards/mean:-1.3489673137664795 - critic/advantages/mean:-0.31142449378967285 - critic/advantages/max:1.7888524532318115 - critic/advantages/min:-1.788852572441101 - critic/format_reward/mean:0.5767275094985962 - critic/skip_freq:0.4515553116798401 - response_length/mean:8.210493087768555 - response_length/max:16.299999237060547 - response_length/min:1.0 - response_length/clip_ratio:0.0 - prompt_length/mean:28.4423828125 - prompt_length/max:128.0 - prompt_length/min:2.0 - prompt_length/clip_ratio:0.0009765625 - timing_s/start_profile:5.630019586533308e-06 - timing_s/generate_sequences:36.14552307128906 - timing_s/reshard:0.726629912853241 - timing_s/gen:37.91423832799774 - timing_s/reward:0.8689461869653314 - timing_s/old_log_prob:2.451821263995953 - timing_s/ref:2.35992446297314 - timing_s/adv:0.43670086096972227 - timing_s/update_actor:9.725809871044476 - timing_s/step:53.9062067939667 - timing_s/stop_profile:2.6760390028357506e-06 - timing_per_token_ms/gen:0.9019098183539581 - timing_per_token_ms/adv:0.002327051668538353 - timing_per_token_ms/ref:0.01257534997066762 - timing_per_token_ms/update_actor:0.05182600748265986 - perf/total_num_tokens:1467135 - perf/time_per_step:53.9062067939667 - perf/throughput:3402.0549006710226
[36m(TaskRunner pid=3376910)[0m global_steps 4
